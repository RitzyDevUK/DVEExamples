"use strict";(self.webpackChunkdivinecraft=self.webpackChunkdivinecraft||[]).push([[790],{36078:(t,e,s)=>{s.d(e,{x:()=>r});class r{x;y;static ApplyMatrix(t,e){return{x:t[0]*e.x+t[1]*e.y+t[2],y:t[3]*e.x+t[4]*e.y+t[5]}}static ApplyMatrixArray(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2],t[3]*e[0]+t[4]*e[1]+t[5]]}static RotateAroundPivot(t,e,s){const a={x:e.x-s.x,y:e.y-s.y},i=r.ApplyMatrix(t,a);return{x:i.x+s.x,y:i.y+s.y}}static RotateAroundPivotArray(t,e,s){const a=[e[0]-s[0],e[1]-s[1]],i=r.ApplyMatrixArray(t,a);return[i[0]+s[0],i[1]+s[1]]}static Create(t=0,e=0){return new r(t,e)}static Add(t,e){return{x:t.x+e.x,y:t.y+e.y}}static AddToRef(t,e,s){s.x=t.x+e.x,s.y=t.y+e.y}static AddInPlace(t,e){t.x+=e.x,t.y+=e.y}static AddArray(t,e){return[t[0]+e[0],t[1]+e[1]]}static AddArrayToRef(t,e,s){s[0]=t[0]+e[0],s[1]=t[1]+e[1]}static AddArrayInPlace(t,e){t[0]+=e[0],t[1]+=e[1]}static AddScalar(t,e){return{x:t.x+e,y:t.y+e}}static AddScalarToRef(t,e,s){s.x=t.x+e,s.y=t.y+e}static AddScalarInPlace(t,e){t.x+=e,t.y+=e}static AddScalarArray(t,e){return[t[0]+e,t[1]+e]}static AddScalarArrayToRef(t,e,s){s[0]=t[0]+e,s[1]=t[1]+e}static AddScalarArrayInPlace(t,e){t[0]+=e,t[1]+=e}static Subtract(t,e){return{x:t.x-e.x,y:t.y-e.y}}static SubtractToRef(t,e,s){s.x=t.x-e.x,s.y=t.y-e.y}static SubtractInPlace(t,e){t.x-=e.x,t.y-=e.y}static SubtractArray(t,e){return[t[0]-e[0],t[1]-e[1]]}static SubtractArrayToRef(t,e,s){s[0]=t[0]-e[0],s[1]=t[1]-e[1]}static SubtractArrayInPlace(t,e){t[0]-=e[0],t[1]-=e[1]}static SubtractScalar(t,e){return{x:t.x-e,y:t.y-e}}static SubtractScalarToRef(t,e,s){s.x=t.x-e,s.y=t.y-e}static SubtractScalarInPlace(t,e){t.x-=e,t.y-=e}static SubtractScalarArray(t,e){return[t[0]-e,t[1]-e]}static SubtractScalarArrayToRef(t,e,s){s[0]=t[0]-e,s[1]=t[1]-e}static SubtractScalarArrayInPlace(t,e){t[0]-=e,t[1]-=e}static Multiply(t,e){return{x:t.x*e.x,y:t.y*e.y}}static MultiplyToRef(t,e,s){s.x=t.x*e.x,s.y=t.y*e.y}static MultiplyInPlace(t,e){t.x*=e.x,t.y*=e.y}static MultiplyArray(t,e){return[t[0]*e[0],t[1]*e[1]]}static MultiplyArrayToRef(t,e,s){s[0]=t[0]*e[0],s[1]=t[1]*e[1]}static MultiplyArrayInPlace(t,e){t[0]*=e[0],t[1]*=e[1]}static MultiplyScalar(t,e){return{x:t.x*e,y:t.y*e}}static MultiplyScalarToRef(t,e,s){s.x=t.x*e,s.y=t.y*e}static MultiplyScalarInPlace(t,e){t.x*=e,t.y*=e}static MultiplyScalarArray(t,e){return[t[0]*e,t[1]*e]}static MultiplyScalarArrayToRef(t,e,s){s[0]=t[0]*e,s[1]=t[1]*e}static MultiplyScalarArrayInPlace(t,e){t[0]*=e,t[1]*=e}static Divide(t,e){return{x:t.x/e.x,y:t.y/e.y}}static DivideToRef(t,e,s){s.x=t.x/e.x,s.y=t.y/e.y}static DivideInPlace(t,e){t.x/=e.x,t.y/=e.y}static DivideArray(t,e){return[t[0]/e[0],t[1]/e[1]]}static DivideArrayToRef(t,e,s){s[0]=t[0]/e[0],s[1]=t[1]/e[1]}static DivideArrayInPlace(t,e){t[0]/=e[0],t[1]/=e[1]}static DivideScalar(t,e){return{x:t.x/e,y:t.y/e}}static DivideScalarToRef(t,e,s){s.x=t.x/e,s.y=t.y/e}static DivideScalarInPlace(t,e){t.x/=e,t.y/=e}static DivideScalarArray(t,e){return[t[0]/e,t[1]/e]}static DivideScalarArrayToRef(t,e,s){s[0]=t[0]/e,s[1]=t[1]/e}static DivideScalarArrayInPlace(t,e){t[0]/=e,t[1]/=e}static Dot(t,e){return t.x*e.x+t.y*e.y}static DotArray(t,e){return t[0]*e[0]+t[1]*e[1]}static Length(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static LengthArray(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}static Normalize(t){const e=r.Length(t);return 0===e?{x:0,y:0}:{x:t.x/e,y:t.y/e}}static NormalizeToRef(t,e){const s=r.Length(t);0===s?(e.x=0,e.y=0):(e.x=t.x/s,e.y=t.y/s)}static NormalizeInPlace(t){const e=r.Length(t);0===e?(t.x=0,t.y=0):(t.x/=e,t.y/=e)}static NormalizeArray(t){const e=r.LengthArray(t);return 0===e?[0,0]:[t[0]/e,t[1]/e]}static NormalizeArrayToRef(t,e){const s=r.LengthArray(t);0===s?(e[0]=0,e[1]=0):(e[0]=t[0]/s,e[1]=t[1]/s)}static NormalizeArrayInPlace(t){const e=r.LengthArray(t);0===e?(t[0]=0,t[1]=0):(t[0]/=e,t[1]/=e)}static Distance(t,e){return r.Length(r.Subtract(t,e))}static DistanceArray(t,e){return r.LengthArray(r.SubtractArray(t,e))}static Lerp(t,e,s){return{x:t.x+s*(e.x-t.x),y:t.y+s*(e.y-t.y)}}static LerpToRef(t,e,s,r){r.x=t.x+s*(e.x-t.x),r.y=t.y+s*(e.y-t.y)}static LerpInPlace(t,e,s){t.x+=s*(e.x-t.x),t.y+=s*(e.y-t.y)}static LerpArray(t,e,s){return[t[0]+s*(e[0]-t[0]),t[1]+s*(e[1]-t[1])]}static LerpArrayToRef(t,e,s,r){r[0]=t[0]+s*(e[0]-t[0]),r[1]=t[1]+s*(e[1]-t[1])}static LerpArrayInPlace(t,e,s){t[0]+=s*(e[0]-t[0]),t[1]+=s*(e[1]-t[1])}static Negate(t){return{x:-t.x,y:-t.y}}static NegateToRef(t,e){e.x=-t.x,e.y=-t.y}static NegateInPlace(t){t.x=-t.x,t.y=-t.y}static NegateArray(t){return[-t[0],-t[1]]}static NegateArrayToRef(t,e){e[0]=-t[0],e[1]=-t[1]}static NegateArrayInPlace(t){t[0]=-t[0],t[1]=-t[1]}static Equals(t,e){return t.x===e.x&&t.y===e.y}static EqualsArray(t,e){return t[0]===e[0]&&t[1]===e[1]}static Clone(t){return{x:t.x,y:t.y}}static CloneArray(t){return[t[0],t[1]]}static Copy(t,e){return t.x=e.x,t.y=e.y,t}static CopyArray(t,e){return t[0]=e[0],t[1]=e[1],t}static CopyFromArray(t,e){return t.x=e[0],t.y=e[1],t}static CopyIntoArray(t,e){return t[0]=e.x,t[1]=e.y,t}static ToArray(t){return[t.x,t.y]}static FromArray(t){return new r(t[0],t[1])}constructor(t,e){this.x=t,this.y=e}}},56964:(t,e,s)=>{var r;s.d(e,{z:()=>r}),function(t){t[t.BuildSection=0]="BuildSection",t[t.BuildSector=1]="BuildSector",t[t.Generate=2]="Generate",t[t.Decorate=3]="Decorate",t[t.RGBlightUpdate=4]="RGBlightUpdate",t[t.RGBlightRemove=5]="RGBlightRemove",t[t.WorldSun=6]="WorldSun",t[t.SunLightUpdate=7]="SunLightUpdate",t[t.SunLightRemove=8]="SunLightRemove",t[t.Propagation=9]="Propagation",t[t.AnalyzerUpdate=10]="AnalyzerUpdate",t[t.FlowUpdate=11]="FlowUpdate",t[t.FlowRemove=12]="FlowRemove",t[t.ConstructEntity=13]="ConstructEntity",t[t.ConstructItem=14]="ConstructItem",t[t.Explosion=15]="Explosion",t[t.VoxelErease=16]="VoxelErease",t[t.VoxelPaint=17]="VoxelPaint",t[t.VoxelUpdate=18]="VoxelUpdate"}(r||(r={}))},67768:(t,e,s)=>{s.d(e,{l:()=>l});var r=s(22879),a=s(75025),i=s(15620),o=s(6774),n=s(33329);const c="dve_air",d=[0,0,0,0,0,0];class l{data={id:c,state:0,secondaryVoxelId:"",level:0,levelState:0,mod:0};dimension="main";x=0;y=0;z=0;name=c;voxelCursor=new o.x;dataCursor=new a.p;substanceData=new i.j;setXYZ(t,e,s){return this.x=t,this.y=e,this.z=s,this}newSector(){n._.sectors.new(this.dimension,this.x,this.y,this.z)}setData(t){return this.data.id=t.id?t.id:c,this.data.state=t.state?t.state:0,this.data.secondaryVoxelId=t.secondaryVoxelId?t.secondaryVoxelId:c,this.data.level=t.level?t.level:0,this.data.levelState=t.levelState?t.levelState:0,this.data.mod=t.mod?t.mod:0,this}getData(){return this.data}setRaw(t){return this.voxelCursor.copyRaw(t).process(),this.data.id=this.voxelCursor.getStringId(),this.data.state=this.voxelCursor.getState(),this.data.levelState=this.voxelCursor.getLevelState(),this.data.level=this.voxelCursor.getLevel(),this.voxelCursor.setSecondary(!0),this.voxelCursor.secondaryId>=2&&(this.data.secondaryVoxelId=this.voxelCursor.getStringId()),this.voxelCursor.setSecondary(!1),this.data.mod=this.voxelCursor.getMod(),this}getRaw(){return o.x.VoxelDataToRaw(this.data)}setId(t){return this.data.id=t,this}setName(t){return this.data.id=r.O.name.getId(t),this.name=t,this}setSecondaryId(t){return this.data.secondaryVoxelId=t,this}setShapeState(t){return this.data.state=t,this}setLevel(t){return this.data.level=t,this}setLevelState(t){return this.data.levelState=t,this}setMod(t){return this.data.mod=t,this}clear(){this.data.id="dve_air",this.data.secondaryVoxelId="",this.data.level=0,this.data.levelState=0,this.data.state=0,this.data.mod=0,this.x=0,this.y=0,this.z=0}_paint(){if(!this.dataCursor.inBounds(this.x,this.y,this.z))return!1;const t=this.dataCursor.getVoxel(this.x,this.y,this.z);if(!t)return;const e=r.O.ids.getNumberId(this.data.id);if(e<0)return!1;if(t.setId(e),t.setState(this.data.state?this.data.state:0),t.setLevel(this.data.level),t.setMod(this.data.mod),this.data.secondaryVoxelId){const e=r.O.ids.getNumberId(this.data.secondaryVoxelId);e>0&&(t.setSecondary(!0),t.setId(e),t.setSecondary(!1))}t.isLightSource()&&t.getLightSourceValue()&&t.setLight(t.getLightSourceValue()),t.updateHeightMap(0)}_erase(){const t=this.dataCursor.getVoxel(this.x,this.y,this.z);t&&t.copyRaw(d).updateHeightMap(1)}paint(){return this._paint(),this}erase(){return this._erase(),this}start(t,e,s,r){return this.dataCursor.setFocalPoint(t,e,s,r),this.dimension=t,this.x=e,this.y=s,this.z=r,this}stop(){return this}}},6774:(t,e,s)=>{s.d(e,{x:()=>o});var r=s(17859),a=s(22879),i=s(13935);class o extends r.S{static VoxelDataToRaw(t,e=0){const s=void 0!==t.id&&a.O.ids.getNumberId(t.id)||0,r=void 0!==t.secondaryVoxelId&&a.O.ids.getNumberId(t.secondaryVoxelId)||0;let o=0;return void 0!==t.level&&(o=i.R.setLevel(o,t.level)),void 0!==t.levelState&&(o=i.R.setLevelState(o,t.levelState)),[s,e,o,t.state||0,t.mod||0,r]}ids=[0];light=[0];level=[0];state=[0];secondary=[0];mod=[0];loadIn(){}}},69519:(t,e,s)=>{s.d(e,{j:()=>c});var r=s(33329),a=s(28517),i=s(95027),o=s(99638),n=s(98720);class c extends n.s{_current=null;_section;voxel=new a.$(this);_voxelIndex=0;_voxelPosition=o.Az.Create();_sectorPosition=o.Az.Create();inBounds(t,e,s){const r=this._sectorPosition.x+i.k.sector.bounds.x,a=this._sectorPosition.y+i.k.sector.bounds.y,o=this._sectorPosition.z+i.k.sector.bounds.z;return!(t<this._sectorPosition.x||e<this._sectorPosition.y||s<this._sectorPosition.z||t>r||e>a||s>o)}setSector(t,e,s,a){const i=r._.sectors.get(t,e,s,a);return!!i&&(this._current=i,this._sectorPosition.x=i.position[0],this._sectorPosition.y=i.position[1],this._sectorPosition.z=i.position[2],!0)}getVoxel(t,e,s){if(!this._current)return null;const r=this._current.sections[i.k.section.getIndex(t,e,s)];if(!r){if(!r)throw new Error(`Could not load section at ${t}-${e}-${s} | ${i.k.section.getIndex(t,e,s)}`);return this._section=null,null}return this._section=r,this._voxelIndex=i.k.voxel.getIndex(t,e,s),i.k.voxel.getPosition(t,e,s,this._voxelPosition),this.voxel.loadIn(),this.voxel}}},28517:(t,e,s)=>{s.d(e,{$:()=>o});var r=s(47980),a=s(28135),i=s(17859);class o extends i.S{dataCursor;_section;get ids(){return this._section.ids}get light(){return this._section.light}get level(){return this._section.level}get state(){return this._section.state}get secondary(){return this._section.secondary}get mod(){return this._section.mod}constructor(t){super(),this.dataCursor=t}loadIn(){this.dataCursor._section&&(this._section=this.dataCursor._section,this._index=this.dataCursor._voxelIndex,this.process())}updateHeightMap(t){r.w.StateStruct.setData(this._section.sectionState);const e=this.dataCursor._voxelPosition;return 0==t?(r.w.StateStruct.setArrayPropertyValue(a.g.heightMap,e.y,1),!0):1==t&&(r.w.StateStruct.setArrayPropertyValue(a.g.dirtyMap,e.y,1),r.w.StateStruct.setArrayPropertyValue(a.g.heightMap,e.y,0),!0)}}},33329:(t,e,s)=>{s.d(e,{_:()=>x});var r=s(95027),a=s(76447),i=s(38717),o=s(99638);class n{static dimension={onNew:t=>{},onRemove:t=>{}};static sectors={onNew:(t,e)=>{},onRemove:(t,e)=>{}}}class c{static add(t){const e=a.f.CreateNew(t);return x._dimensions.set(t,e),e}static get(t){return x._dimensions.get(t)}}const d=o.Az.Create();class l{static _secotrs=[];static _enabled=!1;static getSector(){return this._enabled&&this._secotrs.length?this._secotrs.shift():i.h.CreateNew()}static returnSector(t){t.bufferView.fill(0)}}class u{static setSecotrPool(t){l._enabled=t,l._secotrs.length=0}static add(t,e,s,a,o){let n=x.dimensions.get(t);n||(n=x.dimensions.add(t)),r.k.sector.getPositionVec3Array(e,s,a,o.position);const c=new i.h(o);return n.sectors.set(r.k.hash.hashVec3Array(c.position),c),c}static new(t,e,s,r){if(this.get(t,e,s,r))return!1;let a=x.dimensions.get(t);a||(a=x.dimensions.add(t));const o=this.add(t,e,s,r,i.h.CreateNew());return n.sectors.onNew([t,e,s,r],o),!0}static get(t,e,s,a){let i=x.dimensions.get(t);return i&&i.sectors.get(r.k.hash.hashVec3(r.k.sector.getPosition(e,s,a,d)))||!1}static remove(t,e,s,a){let i=x.dimensions.get(t);if(!i)return!1;const o=r.k.sector.getPosition(e,s,a,d),c=r.k.hash.hashVec3(o),u=i.sectors.get(c);return!!u&&(l._enabled&&l.returnSector(u),n.sectors.onRemove([t,o.x,o.y,o.z],u),i.sectors.delete(c),!0)}}class x{static _dimensions=new Map;static _hooks=n;static dimensions=c;static sectors=u;static clearAll(){this._dimensions.clear()}}},95027:(t,e,s)=>{s.d(e,{k:()=>y});var r=s(71657),a=s(99638),i=s(17480);const o=a.Az.Create(),n=a.Az.Create();class c{static bounds={MinZ:-Number.MAX_SAFE_INTEGER,MaxZ:Number.MAX_SAFE_INTEGER,MinX:-Number.MAX_SAFE_INTEGER,MaxX:Number.MAX_SAFE_INTEGER,MinY:0,MaxY:256};static setWorldBounds(t,e,s,r,a,i){this.bounds.MinX=t,this.bounds.MaxX=e,this.bounds.MinX=s,this.bounds.MaxZ=r,this.bounds.MinY=a,this.bounds.MaxY=i}static inBounds(t,e,s){return!(t<this.bounds.MinX||e<this.bounds.MinY||s<this.bounds.MinZ||t>this.bounds.MaxX||e>this.bounds.MaxY||s>this.bounds.MaxZ)}static getWorldWidth(){return this.bounds.MaxX-this.bounds.MinX}static getWorldDepth(){return this.bounds.MaxZ-this.bounds.MinZ}static getWorldHeightY(){return this.bounds.MaxY-this.bounds.MinY}static getWorldDimensions(){return{width:this.getWorldWidth(),depth:this.getWorldDepth(),height:this.getWorldHeightY()}}}class d{static power2Axes=a.Az.Create();static bounds=a.Az.Create();static volumne=0;static getPosition(t,e,s,r=a.Az.Create()){return(0,i.pN)(t,e,s,d.power2Axes.x,d.power2Axes.y,d.power2Axes.z,r),r}static getPositionVec3Array(t,e,s,r=[0,0,0]){return(0,i.WS)(t,e,s,d.power2Axes.x,d.power2Axes.y,d.power2Axes.z,r),r}}class l{static power2Axes=a.Az.Create();static bounds=a.Az.Create();static volumne=0;static getPosition(t,e,s,r=a.Az.Create()){return(0,i.pN)(t,e,s,l.power2Axes.x,l.power2Axes.y,l.power2Axes.z,r),r}static getPositionVec3Array(t,e,s,r=[0,0,0]){return(0,i.WS)(t,e,s,l.bounds.x,l.bounds.y,l.bounds.z,r),r}static getIndex(t,e,s){return l.getPosition(t,e,s,o),d.getPosition(t,e,s,n),(o.y-n.y)/l.bounds.y}}class u{static bounds=a.Az.Create();static getPosition(t,e,s,r=a.Az.Create()){return(0,i.pN)(t,e,s,l.power2Axes.x,l.power2Axes.y,l.power2Axes.z,r),r.x=t-r.x,r.y=e-r.y,r.z=s-r.z,r}static getPositionVec3Array(t,e,s,r=[0,0,0]){return(0,i.WS)(t,e,s,l.power2Axes.x,l.power2Axes.y,l.power2Axes.z,r),r[0]=t-r[0],r[1]=e-r[1],r[2]=s-r[2],r}static getIndex(t,e,s){const r=this.getPosition(t,e,s,o);return(0,i.BN)(r.x,r.y,r.z,l.bounds.x,l.bounds.y,l.bounds.z)}}class x{static hashVec3(t){return`${t.x}-${t.y}-${t.z}`}static hashVec3Array(t){return`${t[0]}-${t[1]}-${t[2]}`}static hashXYZ(t,e,s){return`${t}-${e}-${s}`}}class y{static hash=x;static world=c;static sector=d;static section=l;static voxel=u}r.i.addEventListener("synced",(t=>{const{settings:e}=t.detail.settings;c.setWorldBounds(e.world.minX,e.world.maxX,e.world.minZ,e.world.maxZ,e.world.minY,e.world.maxY),d.power2Axes.x=e.sectors.sectorXPow2,d.power2Axes.y=e.sectors.sectorYPow2,d.power2Axes.z=e.sectors.sectorZPow2,d.bounds.x=1<<d.power2Axes.x,d.bounds.y=1<<d.power2Axes.y,d.bounds.z=1<<d.power2Axes.z,l.power2Axes.x=e.sections.sectionXPow2,l.power2Axes.y=e.sections.sectionYPow2,l.power2Axes.z=e.sections.sectionZPow2,l.bounds.x=1<<l.power2Axes.x,l.bounds.y=1<<l.power2Axes.y,l.bounds.z=1<<l.power2Axes.z,l.volumne=l.bounds.x*l.bounds.y*l.bounds.z,d.volumne=d.bounds.x/l.bounds.x*(d.bounds.y/l.bounds.y)*(d.bounds.z/l.bounds.z)}))},83051:(t,e,s)=>{var r;s.d(e,{m:()=>r}),function(t){t.RunBuildQueue="run-build-queue-for-tasks",t.PlaceVoxel="place-voxel",t.RemoveVoxel="remove-voxel",t.PlaceVoxelArea="place-voxel-area",t.RemoveVoxelArea="remove-voxel-area",t.BuildTemplate="build-template"}(r||(r={}))}}]);