"use strict";(self.webpackChunkdivinecraft=self.webpackChunkdivinecraft||[]).push([[968],{35238:(t,e,s)=>{s.d(e,{P:()=>i});var r=s(62307);class i{buffer;data;constructor(t){return this.buffer=t,this.data=new DataView(ArrayBuffer.isView(t)?t.buffer:t),new Proxy(this,{get:(t,e)=>{if("string"==typeof e&&!isNaN(Number(e))){const s=Number(e);return t.get(s)}return t[e]},set:(t,e,s)=>{if("string"==typeof e&&!isNaN(Number(e))){const r=Number(e);return t.set(r,s),!0}return t[e]=s,!0}})}get length(){return 8*this.buffer.byteLength}get(t){if(t<0||t>=this.length)throw new RangeError(`Index ${t} is out of bounds`);return r.u.getBitArrayIndex(this.data,0,t)}set(t,e){if(t<0||t>=this.length)throw new RangeError(`Index ${t} is out of bounds`);if(e<0||e>1)throw new RangeError(`Value ${e} is out of bounds for a bit`);r.u.setBitArrayIndex(this.data,0,t,e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.length?{value:this.get(t++),done:!1}:{value:void 0,done:!0}}}forEach(t){for(let e=0;e<this.length;e++)t(this.get(e),e,this)}}},95873:(t,e,s)=>{var r,i;s.d(e,{QI:()=>r,Yd:()=>n,bI:()=>i}),function(t){t[t.Int8=0]="Int8",t[t.Uint8=1]="Uint8",t[t.Uint8Clamped=2]="Uint8Clamped",t[t.Int16=3]="Int16",t[t.Uint16=4]="Uint16",t[t.Float32=5]="Float32",t[t.Int32=6]="Int32",t[t.Uint32=7]="Uint32",t[t.Float64=8]="Float64",t[t.BigInt=9]="BigInt",t[t.BigUint=10]="BigUint"}(r||(r={})),function(t){t[t.Int8=1]="Int8",t[t.Uint8=1]="Uint8",t[t.Uint8Clamped=1]="Uint8Clamped",t[t.Int16=2]="Int16",t[t.Uint16=2]="Uint16",t[t.Float32=4]="Float32",t[t.Int32=4]="Int32",t[t.Uint32=4]="Uint32",t[t.Float64=8]="Float64",t[t.BigInt=8]="BigInt",t[t.BigUint=8]="BigUint"}(i||(i={}));const n={[r.Int8]:i.Int8,[r.Uint8]:i.Uint8,[r.Uint8Clamped]:i.Uint8Clamped,[r.Int16]:i.Int16,[r.Uint16]:i.Uint16,[r.Float32]:i.Float32,[r.Int32]:i.Int32,[r.Uint32]:i.Uint32,[r.Float64]:i.Float64,[r.BigInt]:i.BigInt,[r.BigUint]:i.BigUint}},45466:(t,e,s)=>{s.d(e,{R:()=>i});var r=s(14494);class i{data;get length(){return this.data[2]}get marker(){return this.data[0]}get numberType(){return r.c[this.marker]}get listType(){return this.data[1]}get value(){return this.data[3]}set value(t){this.data[3]=t}constructor(t,e,s=0,r=0){this.data=[t,s,r,e]}}},14494:(t,e,s)=>{s.d(e,{A:()=>r,c:()=>n});var r,i=s(95873);!function(t){t[t.Name=0]="Name",t[t.Object=1]="Object",t[t.ObjectEnd=2]="ObjectEnd",t[t.Array=3]="Array",t[t.ArrayEnd=4]="ArrayEnd",t[t.Int8=5]="Int8",t[t.Uint8=6]="Uint8",t[t.Uint8Clamped=7]="Uint8Clamped",t[t.Int16=8]="Int16",t[t.Uint16=9]="Uint16",t[t.Float32=10]="Float32",t[t.Int32=11]="Int32",t[t.Uint32=12]="Uint32",t[t.Float64=13]="Float64",t[t.BigInt=14]="BigInt",t[t.BigUint=15]="BigUint",t[t.String=16]="String",t[t.Boolean=17]="Boolean",t[t.Undefined=18]="Undefined",t[t.ArrayBuffer=19]="ArrayBuffer",t[t.TypedArray=20]="TypedArray",t[t.Json=21]="Json",t[t.Blob=22]="Blob"}(r||(r={}));const n={[r.Int8]:i.QI.Int8,[r.Uint8]:i.QI.Uint8,[r.Uint8Clamped]:i.QI.Uint8Clamped,[r.Int16]:i.QI.Int16,[r.Uint16]:i.QI.Uint16,[r.Float32]:i.QI.Float32,[r.Int32]:i.QI.Int32,[r.Uint32]:i.QI.Uint32,[r.Float64]:i.QI.Float64,[r.BigInt]:i.QI.BigInt,[r.BigUint]:i.QI.BigUint}},93634:(t,e,s)=>{s(5484),s(89066)},89066:(t,e,s)=>{var r=s(337);s(33309),r.q},337:(t,e,s)=>{s.d(e,{q:()=>c});var r=s(85605),i=s(392),n=s(5213),a=s(93018),o=s(62307);class c{id;byteOffSet=0;structSize=0;structArrayIndexes=0;structArrayIndex=0;structData;data=new DataView(new ArrayBuffer(0));indexMap={};index=new DataView(new ArrayBuffer(0));constructor(t){this.id=t}setData(t){this.data=t}setBuffer(t){this.data=new DataView(t)}getBuffer(){return this.data instanceof DataView?this.data.buffer:this.data}setStructArrayIndex(t){this.structArrayIndex=t,this.byteOffSet=t*this.structSize}getProperty(t){const e=this.indexMap[t];if(void 0===e)throw new Error(`Tag with id: ${t} does not exist.`);const s=(0,n.b)(this.index,e);return s[4]==i.W.Boolean?r.y.getBitValue(this.data.getUint8(s[0]+this.byteOffSet),s[1],s[2]):s[4]==i.W.TypedNumber?r.y.getTypedNumber(this.data,s[0]+this.byteOffSet,s[2]):-1/0}setProperty(t,e){const s=this.indexMap[t];if(void 0===s)throw new Error(`Tag with id: ${t} does not exist.`);const a=(0,n.b)(this.index,s);return a[4]==i.W.Boolean?(this.data.setUint8(a[0]+this.byteOffSet,r.y.setBitValue(this.data.getUint8(a[0]+this.byteOffSet),a[1],e,a[2])),!0):a[4]==i.W.TypedNumber&&(r.y.setTypedNumber(this.data,a[0]+this.byteOffSet,a[2],e),!0)}getArrayPropertyValue(t,e){const s=this.indexMap[t];if(void 0===s)throw new Error(`Tag with id: ${t} does not exist.`);const a=(0,n.b)(this.index,s);if(a[4]==i.W.TypedNumberArray)return r.y.getTypedNumber(this.data,a[0]+this.byteOffSet+e*r.y.getTypedSize(a[2]),a[2]);if(a[4]==i.W.BitArray)return o.u.getBitArrayIndex(this.data,a[0]+this.byteOffSet,e);throw new Error(`Tag with id: ${t} is not an array.`)}getArrayPropertyByteIndex(t,e){const s=this.indexMap[t];if(void 0===s)throw new Error(`Tag with id: ${t} does not exist.`);const a=(0,n.b)(this.index,s);return a[4]==i.W.TypedNumberArray?a[0]+this.byteOffSet+e*r.y.getTypedSize(a[2]):-1/0}setArrayPropertyValue(t,e,s){const a=this.indexMap[t];if(void 0===a)throw new Error(`Tag with id: ${t} does not exist.`);const c=(0,n.b)(this.index,a);return c[4]==i.W.TypedNumberArray?r.y.setTypedNumber(this.data,c[0]+this.byteOffSet+e*r.y.getTypedSize(c[2]),c[2],s):c[4]==i.W.BitArray?o.u.setBitArrayIndex(this.data,c[0]+this.byteOffSet,e,s):-1/0}instantiate(){const t=(0,a.k)(this.structData);return t.setBuffer(this.getBuffer()),t.setIndex(this.structArrayIndex),t}}},19507:(t,e,s)=>{s.d(e,{g:()=>r});class r{structByteOffSet=0;structSize=0;structArrayIndexes=0;structArrayIndex=0;structData;setData(t){this.structData=t}setBuffer(t){this.structData=new DataView(t)}setIndex(t){this.structArrayIndex=t,this.structByteOffSet=t*this.structSize}serialize(){throw new Error("Not implemented")}deserialize(t){throw new Error("Not implemented")}createClone(){throw new Error("Not implemented")}setDefaults(){throw new Error("Not implemented")}getKeys(){throw new Error("Not implemented")}}},5484:(t,e,s)=>{s.d(e,{j:()=>i});var r=s(337);class i extends r.q{id;constructor(t){super(t),this.id=t}init(t){this.structData=t,this.data=new DataView(t.buffer),this.index=new DataView(t.indexBuffer),this.indexMap=t.indexMap,this.structArrayIndexes=t.structArrayIndexes,this.structSize=t.structSize}}},392:(t,e,s)=>{var r;s.d(e,{W:()=>r}),function(t){t[t.Boolean=0]="Boolean",t[t.TypedNumber=1]="TypedNumber",t[t.TypedNumberArray=2]="TypedNumberArray",t[t.BitArray=3]="BitArray",t[t.Vector2=4]="Vector2",t[t.Vector3=5]="Vector3",t[t.Vector4=6]="Vector4"}(r||(r={}))},33309:(t,e,s)=>{s.d(e,{P:()=>c});var r=s(85605),i=s(95873),n=s(392),a=s(5213);const o=2*i.bI.Uint32+3*i.bI.Uint8;function c(t,e=1,s=!1){const i=new Map;for(const e of t)i.set(e.id,e);const c={},d=new Map,h=[],u=[],l=new Map,y=new Map,g=new Map,f=new Map,p=new Map,x=[];i.forEach((t=>{if(t.default&&(c[t.id]=t.default),"header"==t.type){let e=d.get(t.numberType);e||(e=[],d.set(t.numberType,e)),e.push(t)}if("boolean"==t.type&&h.push(t),"number"==t.type){const e=t.range,s=r.y.calculateBitsNeeded(e[0],e[1]);u[s]??=[],u[s].push(t)}if("typed-number"==t.type){let e=l.get(t.numberType);e||(e=[],l.set(t.numberType,e)),e.push(t)}if("typed-number-array"==t.type){let e=y.get(t.numberType);e||(e=[],y.set(t.numberType,e)),e.push(t)}if("vector-2"==t.type){let e=g.get(t.numberType);e||(e=[],g.set(t.numberType,e)),e.push(t)}if("vector-3"==t.type){let e=f.get(t.numberType);e||(e=[],f.set(t.numberType,e)),e.push(t)}if("vector-4"==t.type){let e=p.get(t.numberType);e||(e=[],p.set(t.numberType,e)),e.push(t)}"bit-array"==t.type&&x.push(t)}));const S=i.size*o;let m=new ArrayBuffer(S);s&&(m=new SharedArrayBuffer(S));const _={},I=new DataView(m);let w=0,b=0,v=0,A=1;d.forEach(((t,e)=>{const s=r.y.getTypedSize(e);for(let e=0;e<t.length;e++){const r=t[e];_[r.id]=w,w=(0,a.z)(I,w,b,0,r.numberType,0,n.W.TypedNumber),b+=s}})),A=1;for(let t=0;t<h.length;t++){const e=h[t];_[e.id]=w,w=(0,a.z)(I,w,b,v,1,0,n.W.Boolean),v++,v>=8&&(b++,v=0)}return v=0,b++,l.forEach(((t,e)=>{const s=r.y.getTypedSize(e);for(let e=0;e<t.length;e++){const r=t[e];_[r.id]=w,w=(0,a.z)(I,w,b,0,r.numberType,0,n.W.TypedNumber),b+=s}})),b++,y.forEach(((t,e)=>{const s=r.y.getTypedSize(e);for(let e=0;e<t.length;e++){const r=t[e];_[r.id]=w,w=(0,a.z)(I,w,b,0,r.numberType,r.length,n.W.TypedNumberArray),b+=s*r.length}})),b++,g.forEach(((t,e)=>{const s=r.y.getTypedSize(e);for(let e=0;e<t.length;e++){const r=t[e];_[r.id]=w,w=(0,a.z)(I,w,b,0,r.numberType,2,n.W.Vector2),b+=2*s}})),b++,f.forEach(((t,e)=>{const s=r.y.getTypedSize(e);for(let e=0;e<t.length;e++){const r=t[e];_[r.id]=w,w=(0,a.z)(I,w,b,0,r.numberType,3,n.W.Vector3),b+=3*s}})),b++,p.forEach(((t,e)=>{const s=r.y.getTypedSize(e);for(let e=0;e<t.length;e++){const r=t[e];_[r.id]=w,w=(0,a.z)(I,w,b,0,r.numberType,4,n.W.Vector4),b+=4*s}})),b++,x.forEach((t=>{const e=Math.ceil(t.length/8)+1;_[t.id]=w,w=(0,a.z)(I,w,b,0,e,t.length,n.W.BitArray),b+=e})),{bufferSize:b*e,buffer:new ArrayBuffer(0),indexBuffer:m,indexMap:_,propertyDefaults:c,structSize:b,structArrayIndexes:e}}},93018:(t,e,s)=>{s.d(e,{k:()=>y});var r=s(19507),i=s(392),n=s(85605),a=s(5213),o=s(49031),c=s(62307),d=s(35238);const h={x:0,y:1},u={x:0,y:1,z:2},l={x:0,y:1,z:2,w:3};function y(t){const e=new DataView(t.indexBuffer),s=class extends r.g{constructor(){super(),this.structSize=t.structSize,this.structArrayIndexes=t.structArrayIndexes}_props=new Map},y=[];Object.defineProperty(s.prototype,"createClone",{get(){return()=>{const t=new s;return this.structData?.buffer&&t.setBuffer(this.structData.buffer),t.setIndex(this.structArrayIndex),t}}}),Object.defineProperty(s.prototype,"getKeys",{get:()=>()=>y});const g=(s,r)=>{for(const[n,o]of Object.entries(t.indexMap)){const[t,c,h,u,l]=(0,a.b)(e,o);if(void 0!==r[n]){if(l==i.W.Boolean&&(s[n]=r[n]?1:0),l==i.W.TypedNumber&&(s[n]=Number(r[n])),l==i.W.TypedNumberArray)for(let t=0;t<r[n].length;t++)s[n][t]=r[n][t];if(l==i.W.BitArray){const t=new d.P(r[n]),e=[],i=[];for(let r=0;r<u;r++)s[n][r]=t[r],e[r]=s[n][r],i[r]=t[r]}l==i.W.Vector2&&(s[n].x=r[n].x,s[n].y=r[n].y),l==i.W.Vector3&&(s[n].x=r[n].x,s[n].y=r[n].y,s[n].z=r[n].z),l==i.W.Vector4&&(s[n].x=r[n].x,s[n].y=r[n].y,s[n].z=r[n].z,s[n].w=r[n].w)}}};Object.defineProperty(s.prototype,"serialize",{get(){return()=>(s=>{const r={};for(const[n,d]of Object.entries(t.indexMap)){const[t,h,u,l,y]=(0,a.b)(e,d);if(y==i.W.Boolean&&(r[n]=Boolean(s[n])),y==i.W.TypedNumber&&(r[n]=Number(s[n])),y==i.W.TypedNumberArray){const t=new o.Q[u](l);for(let e=0;e<l;e++)t[e]=s[n][e];r[n]=t}if(y==i.W.BitArray){const t=new Uint8Array(Math.ceil(l/8)),e=new DataView(t.buffer);for(let t=0;t<l;t++)c.u.setBitArrayIndex(e,0,t,s[n][t]);r[n]=t}y==i.W.Vector2&&(r[n]={x:s[n].x,y:s[n].y}),y==i.W.Vector3&&(r[n]={x:s[n].x,y:s[n].y,z:s[n].z}),y==i.W.Vector4&&(r[n]={x:s[n].x,y:s[n].y,z:s[n].z,w:s[n].w})}return r})(this)}}),Object.defineProperty(s.prototype,"deserialize",{get(){return t=>g(this,t)}}),Object.defineProperty(s.prototype,"setDefaults",{get(){return()=>{for(const[e,s]of Object.entries(t.propertyDefaults)){const t=this[e];if(Array.isArray(t)&&Array.isArray(s))for(let e=0;e<s.length;e++)t[e]=s[e];else if("object"!=typeof t||"object"!=typeof s)"number"==typeof t&&"number"==typeof s&&(this[e]=s);else for(const e of Object.keys(s))t[e]=s[e]}}}});for(const[r,o]of Object.entries(t.indexMap)){y.push(r);const[t,d,g,f,p]=(0,a.b)(e,o);if(p==i.W.Boolean&&Object.defineProperty(s.prototype,r,{get(){return n.y.getBitValue(this.structData.getUint8(t+this.structByteOffSet),d,g)},set(e){this.structData.setUint8(t+this.structByteOffSet,n.y.setBitValue(this.structData.getUint8(t+this.structByteOffSet),d,e,g))}}),p==i.W.TypedNumber&&Object.defineProperty(s.prototype,r,{get(){return n.y.getTypedNumber(this.structData,t+this.structByteOffSet,g)},set(e){n.y.setTypedNumber(this.structData,t+this.structByteOffSet,g,e)}}),p==i.W.BitArray&&Object.defineProperty(s.prototype,r,{get(){const e=this;if(!e._props.has(r)){const s=new Proxy(new Array(f),{get:(s,r)=>c.u.getBitArrayIndex(e.structData,t+e.structByteOffSet,+r),set:(s,r,i)=>(c.u.setBitArrayIndex(e.structData,t+e.structByteOffSet,+r,i),!0)});e._props.set(r,s)}return e._props.get(r)}}),p==i.W.TypedNumberArray){const e=n.y.getTypedSize(g);Object.defineProperty(s.prototype,r,{get(){this._props||(this._props=new Map);const s=this;if(!s._props.has(r)){const i=new Proxy(new Array(f),{get:(r,i)=>n.y.getTypedNumber(s.structData,t+s.structByteOffSet+ +i*e,g),set:(r,i,a)=>(n.y.setTypedNumber(s.structData,t+s.structByteOffSet+ +i*e,g,a),!0)});s._props.set(r,i)}return s._props.get(r)}})}if(p==i.W.Vector2){const e=n.y.getTypedSize(g);Object.defineProperty(s.prototype,r,{get(){this._props||(this._props=new Map);const s=this;if(!s._props.has(r)){const i=new Proxy({},{get:(r,i)=>n.y.getTypedNumber(s.structData,t+s.structByteOffSet+h[i]*e,g),set:(r,i,a)=>(n.y.setTypedNumber(s.structData,t+s.structByteOffSet+h[i]*e,g,a),!0)});s._props.set(r,i)}return s._props.get(r)}})}if(p==i.W.Vector3){const e=n.y.getTypedSize(g);Object.defineProperty(s.prototype,r,{get(){this._props||(this._props=new Map);const s=this;if(!s._props.has(r)){const i=new Proxy({},{get:(r,i)=>n.y.getTypedNumber(s.structData,t+s.structByteOffSet+u[i]*e,g),set:(r,i,a)=>(n.y.setTypedNumber(s.structData,t+s.structByteOffSet+u[i]*e,g,a),!0)});s._props.set(r,i)}return s._props.get(r)}})}if(p==i.W.Vector4){const e=n.y.getTypedSize(g);Object.defineProperty(s.prototype,r,{get(){this._props||(this._props=new Map);const s=this;if(!s._props.has(r)){const i=new Proxy({},{get:(r,i)=>n.y.getTypedNumber(s.structData,t+s.structByteOffSet+l[i]*e,g),set:(r,i,a)=>(n.y.setTypedNumber(s.structData,t+s.structByteOffSet+l[i]*e,g,a),!0)});s._props.set(r,i)}return s._props.get(r)}})}}return new s}},5213:(t,e,s)=>{s.d(e,{b:()=>a,z:()=>o});var r=s(95873),i=s(85605);const n=[0,0,0,0,0],a=(t,e)=>(n[0]=t.getUint32(e),e+=i.y.getTypedSize(r.QI.Uint32),n[1]=t.getUint8(e),e+=i.y.getTypedSize(r.QI.Uint8),n[2]=t.getUint8(e),e+=i.y.getTypedSize(r.QI.Uint8),n[3]=t.getUint32(e),e+=i.y.getTypedSize(r.QI.Uint32),n[4]=t.getUint8(e),e+=i.y.getTypedSize(r.QI.Uint8),n),o=(t,e,s,i,n,a,o)=>(t.setUint32(e,s),e+=r.bI.Uint32,t.setUint8(e,i),e+=r.bI.Uint8,t.setUint8(e,n),e+=r.bI.Uint8,t.setUint32(e,a),e+=r.bI.Uint32,t.setUint8(e,o),e+r.bI.Uint8)},10379:(t,e,s)=>{s.d(e,{gZ:()=>i.g,jm:()=>r.j}),s(93634);var r=s(5484),i=(s(89066),s(337),s(19507));s(85605)},62307:(t,e,s)=>{s.d(e,{u:()=>i});var r=s(85605);class i{static getBitArrayIndex(t,e,s){const i=s/8|0,n=s-8*i,a=t.getUint8(i+e);return r.y.getBitValue(a,n,1)}static setBitArrayIndex(t,e,s,i){const n=s/8|0,a=s-8*n,o=t.getUint8(n+e);t.setUint8(n+e,r.y.setBitValue(o,a,i,1))}static getNibbleArrayIndex(t,e,s){const i=s/2|0,n=s%2==0,a=t.getUint8(i+e);return r.y.getBitValue(a,n?4:0,4)}static setNibbleArrayIndex(t,e,s,i){const n=s/2|0,a=s%2==0,o=t.getUint8(n+e);t.setUint8(n+e,r.y.setBitValue(o,a?4:0,i,4))}static getHalfNibbleArrayIndex(t,e,s){const i=s/4|0,n=s%4,a=t.getUint8(i+e);return r.y.getBitValue(a,2*n,2)}static setHalfNibbleArrayIndex(t,e,s,i){const n=s/4|0,a=s%4,o=t.getUint8(n+e);t.setUint8(n+e,r.y.setBitValue(o,2*a,i,2))}}},85605:(t,e,s)=>{s.d(e,{y:()=>a});var r=s(25424),i=s(95873),n=s(96692);class a{static setTypedNumber(t,e,s,r){return n.v[s](t,e,r)}static getTypedNumber(t,e,s){return r.n[s](t,e)}static calculateBitsNeeded(t,e){let s=e-t;return Math.ceil(Math.log2(s))}static getTypedSize(t){return i.Yd[t]}static getBitValue(t,e,s){return(2**s-1<<e&t)>>>e}static setBitValue(t,e,s,r){const i=2**r-1;return t&~(i<<e)|(s&i)<<e}}},25424:(t,e,s)=>{s.d(e,{n:()=>i});var r=s(95873);const i={[r.QI.Int8]:(t,e)=>t.getInt8(e),[r.QI.Uint8]:(t,e)=>t.getUint8(e),[r.QI.Uint8Clamped]:(t,e)=>t.getUint8(e),[r.QI.Int16]:(t,e)=>t.getInt16(e,!0),[r.QI.Uint16]:(t,e)=>t.getUint16(e,!0),[r.QI.Float32]:(t,e)=>t.getFloat32(e,!0),[r.QI.Int32]:(t,e)=>t.getInt32(e,!0),[r.QI.Uint32]:(t,e)=>t.getUint32(e,!0),[r.QI.Float64]:(t,e)=>t.getFloat64(e,!0),[r.QI.BigInt]:(t,e)=>t.getBigInt64(e,!0),[r.QI.BigUint]:(t,e)=>t.getBigUint64(e,!0)}},96692:(t,e,s)=>{s.d(e,{v:()=>i});var r=s(95873);const i={[r.QI.Int8]:(t,e,s)=>t.setInt8(e,s),[r.QI.Uint8]:(t,e,s)=>t.setUint8(e,s),[r.QI.Uint8Clamped]:(t,e,s)=>t.setUint8(e,s),[r.QI.Int16]:(t,e,s)=>t.setInt16(e,s,!0),[r.QI.Uint16]:(t,e,s)=>t.setUint16(e,s,!0),[r.QI.Float32]:(t,e,s)=>t.setFloat32(e,s,!0),[r.QI.Int32]:(t,e,s)=>t.setInt32(e,s,!0),[r.QI.Uint32]:(t,e,s)=>t.setUint32(e,s,!0),[r.QI.Float64]:(t,e,s)=>t.setFloat64(e,s,!0),[r.QI.BigInt]:(t,e,s)=>t.setBigInt64(e,s,!0),[r.QI.BigUint]:(t,e,s)=>t.setBigUint64(e,s,!0)}},95541:(t,e,s)=>{s.d(e,{I:()=>i});var r=s(95873);const i={[r.QI.Int8]:(t,e=!1)=>new Int8Array(e?new SharedArrayBuffer(t*Int8Array.BYTES_PER_ELEMENT):new ArrayBuffer(t*Int8Array.BYTES_PER_ELEMENT)),[r.QI.Uint8]:(t,e=!1)=>new Uint8Array(e?new SharedArrayBuffer(t*Uint8Array.BYTES_PER_ELEMENT):new ArrayBuffer(t*Uint8Array.BYTES_PER_ELEMENT)),[r.QI.Uint8Clamped]:(t,e=!1)=>new Uint8ClampedArray(e?new SharedArrayBuffer(t*Uint8ClampedArray.BYTES_PER_ELEMENT):new ArrayBuffer(t*Uint8ClampedArray.BYTES_PER_ELEMENT)),[r.QI.Int16]:(t,e=!1)=>new Int16Array(e?new SharedArrayBuffer(t*Int16Array.BYTES_PER_ELEMENT):new ArrayBuffer(t*Int16Array.BYTES_PER_ELEMENT)),[r.QI.Uint16]:(t,e=!1)=>new Uint16Array(e?new SharedArrayBuffer(t*Uint16Array.BYTES_PER_ELEMENT):new ArrayBuffer(t*Uint16Array.BYTES_PER_ELEMENT)),[r.QI.Int32]:(t,e=!1)=>new Int32Array(e?new SharedArrayBuffer(t*Int32Array.BYTES_PER_ELEMENT):new ArrayBuffer(t*Int32Array.BYTES_PER_ELEMENT)),[r.QI.Uint32]:(t,e=!1)=>new Uint32Array(e?new SharedArrayBuffer(t*Uint32Array.BYTES_PER_ELEMENT):new ArrayBuffer(t*Uint32Array.BYTES_PER_ELEMENT)),[r.QI.Float32]:(t,e=!1)=>new Float32Array(e?new SharedArrayBuffer(t*Float32Array.BYTES_PER_ELEMENT):new ArrayBuffer(t*Float32Array.BYTES_PER_ELEMENT)),[r.QI.Float64]:(t,e=!1)=>new Float64Array(e?new SharedArrayBuffer(t*Float64Array.BYTES_PER_ELEMENT):new ArrayBuffer(t*Float64Array.BYTES_PER_ELEMENT)),[r.QI.BigInt]:(t,e=!1)=>new BigInt64Array(e?new SharedArrayBuffer(t*BigInt64Array.BYTES_PER_ELEMENT):new ArrayBuffer(t*BigInt64Array.BYTES_PER_ELEMENT)),[r.QI.BigUint]:(t,e=!1)=>new BigUint64Array(e?new SharedArrayBuffer(t*BigUint64Array.BYTES_PER_ELEMENT):new ArrayBuffer(t*BigUint64Array.BYTES_PER_ELEMENT))}},79418:(t,e,s)=>{s(49031)},87823:(t,e,s)=>{s.d(e,{J:()=>r});class r{static Create(){return[1,0,0,0,1,0,0,0,1]}static Add(t,e){return t.map(((t,s)=>t+e[s]))}static AddToRef(t,e,s){t.forEach(((t,r)=>s[r]=t+e[r]))}static Multiply(t,e){const s=new Array(9);for(let r=0;r<3;r++)for(let i=0;i<3;i++){s[3*r+i]=0;for(let n=0;n<3;n++)s[3*r+i]+=t[3*r+n]*e[3*n+i]}return s}static MultiplyToRef(t,e,s){for(let r=0;r<3;r++)for(let i=0;i<3;i++){s[3*r+i]=0;for(let n=0;n<3;n++)s[3*r+i]+=t[3*r+n]*e[3*n+i]}}static Transpose(t){return[t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]]}static TransposeToRef(t,e){[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]=[t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]]}static Inverse(t){const e=t[0]*(t[4]*t[8]-t[7]*t[5])-t[1]*(t[3]*t[8]-t[6]*t[5])+t[2]*(t[3]*t[7]-t[6]*t[4]);if(0===e)return null;const s=1/e;return[(t[4]*t[8]-t[7]*t[5])*s,(t[2]*t[7]-t[1]*t[8])*s,(t[1]*t[5]-t[2]*t[4])*s,(t[5]*t[6]-t[3]*t[8])*s,(t[0]*t[8]-t[2]*t[6])*s,(t[2]*t[3]-t[0]*t[5])*s,(t[3]*t[7]-t[4]*t[6])*s,(t[1]*t[6]-t[0]*t[7])*s,(t[0]*t[4]-t[1]*t[3])*s]}static InverseToRef(t,e){const s=this.Inverse(t);return null!==s&&(s.forEach(((t,s)=>e[s]=t)),!0)}static RotationX(t){const e=Math.cos(t),s=Math.sin(t);return[1,0,0,0,e,-s,0,s,e]}static RotationY(t){const e=Math.cos(t),s=Math.sin(t);return[e,0,s,0,1,0,-s,0,e]}static RotationZ(t){const e=Math.cos(t),s=Math.sin(t);return[e,-s,0,s,e,0,0,0,1]}static Scaling(t,e,s){return[t,0,0,0,e,0,0,0,s]}static Transform(t,e,s){return[1,0,0,0,1,0,t,e,s]}static ApplyMatrix(t,e){return{x:t[0]*e.x+t[1]*e.y+t[2]*e.z,y:t[3]*e.x+t[4]*e.y+t[5]*e.z,z:t[6]*e.x+t[7]*e.y+t[8]*e.z}}static ApplyMatrixArray(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2],t[3]*e[0]+t[4]*e[1]+t[5]*e[2],t[6]*e[0]+t[7]*e[1]+t[8]*e[2]]}}},45741:(t,e,s)=>{s.d(e,{A:()=>a});var r=s(87823);const i=t=>t>=0?2*t:-2*t-1,n=(t,e)=>(t+e)*(t+e+1)/2+e;class a{x;y;z;static Create(t=0,e=0,s=0){return new a(t,e,s)}static HashXYZ(t,e,s){const r=i(t),a=i(e),o=i(s),c=n(r,a);return n(c,o)}static Hash(t){return this.HashXYZ(t.x,t.y,t.z)}static HashArray(t){return this.HashXYZ(t[0],t[1],t[2])}static ApplyMatrix(t,e){return r.J.ApplyMatrix(t,e)}static ApplyMatrixArray(t,e){return r.J.ApplyMatrixArray(t,e)}static RotateAroundPivot(t,e,s){const r={x:e.x-s.x,y:e.y-s.y,z:e.z-s.z},i=a.ApplyMatrix(t,r);return{x:i.x+s.x,y:i.y+s.y,z:i.z+s.z}}static RotateAroundPivotArray(t,e,s){const r=[e[0]-s[0],e[1]-s[1],e[2]-s[2]],i=a.ApplyMatrixArray(t,r);return[i[0]+s[0],i[1]+s[1],i[2]+s[2]]}static FloorInPlace(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.z=Math.floor(t.z),t}static FloorArrayInPlace(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),t}static RoundArrayInPlaceToScalar(t,e){return t[0]=Math.round(t[0]*e)/e,t[1]=Math.round(t[1]*e)/e,t[2]=Math.round(t[2]*e)/e,t}static Add(t,e){return{x:t.x+e.x,y:t.y+e.y,z:t.z+e.z}}static AddToRef(t,e,s){s.x=t.x+e.x,s.y=t.y+e.y,s.z=t.z+e.z}static AddInPlace(t,e){t.x+=e.x,t.y+=e.y,t.z+=e.z}static AddArray(t,e){return[t[0]+e[0],t[1]+e[1],t[2]+e[2]]}static AddArrayToRef(t,e,s){s[0]=t[0]+e[0],s[1]=t[1]+e[1],s[2]=t[2]+e[2]}static AddArrayInPlace(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}static AddScalar(t,e){return{x:t.x+e,y:t.y+e,z:t.z+e}}static AddScalarToRef(t,e,s){s.x=t.x+e,s.y=t.y+e,s.z=t.z+e}static AddScalarInPlace(t,e){t.x+=e,t.y+=e,t.z+=e}static AddScalarArray(t,e){return[t[0]+e,t[1]+e,t[2]+e]}static AddScalarArrayToRef(t,e,s){s[0]=t[0]+e,s[1]=t[1]+e,s[2]=t[2]+e}static AddScalarArrayInPlace(t,e){t[0]+=e,t[1]+=e,t[2]+=e}static Subtract(t,e){return{x:t.x-e.x,y:t.y-e.y,z:t.z-e.z}}static SubtractToRef(t,e,s){s.x=t.x-e.x,s.y=t.y-e.y,s.z=t.z-e.z}static SubtractInPlace(t,e){return t.x-=e.x,t.y-=e.y,t.z-=e.z,t}static SubtractArray(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]}static SubtractArrayToRef(t,e,s){s[0]=t[0]-e[0],s[1]=t[1]-e[1],s[2]=t[2]-e[2]}static SubtractArrayInPlace(t,e){t[0]-=e[0],t[1]-=e[1],t[2]-=e[2]}static SubtractScalar(t,e){return{x:t.x-e,y:t.y-e,z:t.z-e}}static SubtractScalarToRef(t,e,s){s.x=t.x-e,s.y=t.y-e,s.z=t.z-e}static SubtractScalarInPlace(t,e){t.x-=e,t.y-=e,t.z-=e}static SubtractScalarArray(t,e){return[t[0]-e,t[1]-e,t[2]-e]}static SubtractScalarArrayToRef(t,e,s){s[0]=t[0]-e,s[1]=t[1]-e,s[2]=t[2]-e}static SubtractScalarArrayInPlace(t,e){t[0]-=e,t[1]-=e,t[2]-=e}static Multiply(t,e){return{x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}}static MultiplyToRef(t,e,s){s.x=t.x*e.x,s.y=t.y*e.y,s.z=t.z*e.z}static MultiplyInPlace(t,e){t.x*=e.x,t.y*=e.y,t.z*=e.z}static MultiplyArray(t,e){return[t[0]*e[0],t[1]*e[1],t[2]*e[2]]}static MultiplyArrayToRef(t,e,s){s[0]=t[0]*e[0],s[1]=t[1]*e[1],s[2]=t[2]*e[2]}static MultiplyArrayInPlace(t,e){t[0]*=e[0],t[1]*=e[1],t[2]*=e[2]}static MultiplyScalar(t,e){return{x:t.x*e,y:t.y*e,z:t.z*e}}static MultiplyScalarToRef(t,e,s){s.x=t.x*e,s.y=t.y*e,s.z=t.z*e}static MultiplyScalarInPlace(t,e){t.x*=e,t.y*=e,t.z*=e}static MultiplyScalarArray(t,e){return[t[0]*e,t[1]*e,t[2]*e]}static MultiplyScalarArrayToRef(t,e,s){s[0]=t[0]*e,s[1]=t[1]*e,s[2]=t[2]*e}static MultiplyScalarArrayInPlace(t,e){t[0]*=e,t[1]*=e,t[2]*=e}static Divide(t,e){return{x:t.x/e.x,y:t.y/e.y,z:t.z/e.z}}static DivideToRef(t,e,s){s.x=t.x/e.x,s.y=t.y/e.y,s.z=t.z/e.z}static DivideInPlace(t,e){return t.x/=e.x,t.y/=e.y,t.z/=e.z,t}static DivideArray(t,e){return[t[0]/e[0],t[1]/e[1],t[2]/e[2]]}static DivideArrayToRef(t,e,s){s[0]=t[0]/e[0],s[1]=t[1]/e[1],s[2]=t[2]/e[2]}static DivideArrayInPlace(t,e){t[0]/=e[0],t[1]/=e[1],t[2]/=e[2]}static DivideScalar(t,e){return{x:t.x/e,y:t.y/e,z:t.z/e}}static DivideScalarToRef(t,e,s){s.x=t.x/e,s.y=t.y/e,s.z=t.z/e}static DivideScalarInPlace(t,e){t.x/=e,t.y/=e,t.z/=e}static DivideScalarArray(t,e){return[t[0]/e,t[1]/e,t[2]/e]}static DivideScalarArrayToRef(t,e,s){s[0]=t[0]/e,s[1]=t[1]/e,s[2]=t[2]/e}static DivideScalarArrayInPlace(t,e){t[0]/=e,t[1]/=e,t[2]/=e}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static DotArray(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}static Cross(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}}static CrossToRef(t,e,s){s.x=t.y*e.z-t.z*e.y,s.y=t.z*e.x-t.x*e.z,s.z=t.x*e.y-t.y*e.x}static CrossInPlace(t,e){const s=t.y*e.z-t.z*e.y,r=t.z*e.x-t.x*e.z,i=t.x*e.y-t.y*e.x;t.x=s,t.y=r,t.z=i}static CrossArray(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}static CrossArrayToRef(t,e,s){s[0]=t[1]*e[2]-t[2]*e[1],s[1]=t[2]*e[0]-t[0]*e[2],s[2]=t[0]*e[1]-t[1]*e[0]}static CrossArrayInPlace(t,e){const s=t[1]*e[2]-t[2]*e[1],r=t[2]*e[0]-t[0]*e[2],i=t[0]*e[1]-t[1]*e[0];t[0]=s,t[1]=r,t[2]=i}static Length(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)}static LengthArray(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}static Normalize(t){const e=a.Length(t);return 0===e?{x:0,y:0,z:0}:{x:t.x/e,y:t.y/e,z:t.z/e}}static NormalizeToRef(t,e){const s=a.Length(t);0===s?(e.x=0,e.y=0,e.z=0):(e.x=t.x/s,e.y=t.y/s,e.z=t.z/s)}static NormalizeInPlace(t){const e=a.Length(t);0===e?(t.x=0,t.y=0,t.z=0):(t.x/=e,t.y/=e,t.z/=e)}static NormalizeArray(t){const e=a.LengthArray(t);return 0===e?[0,0,0]:[t[0]/e,t[1]/e,t[2]/e]}static NormalizeArrayToRef(t,e){const s=a.LengthArray(t);0===s?(e[0]=0,e[1]=0,e[2]=0):(e[0]=t[0]/s,e[1]=t[1]/s,e[2]=t[2]/s)}static NormalizeArrayInPlace(t){const e=a.LengthArray(t);0===e?(t[0]=0,t[1]=0,t[2]=0):(t[0]/=e,t[1]/=e,t[2]/=e)}static Distance(t,e){return a.Length(a.Subtract(t,e))}static DistanceArray(t,e){return a.LengthArray(a.SubtractArray(t,e))}static Lerp(t,e,s){return{x:t.x+s*(e.x-t.x),y:t.y+s*(e.y-t.y),z:t.z+s*(e.z-t.z)}}static LerpToRef(t,e,s,r){r.x=t.x+s*(e.x-t.x),r.y=t.y+s*(e.y-t.y),r.z=t.z+s*(e.z-t.z)}static LerpInPlace(t,e,s){t.x+=s*(e.x-t.x),t.y+=s*(e.y-t.y),t.z+=s*(e.z-t.z)}static LerpArray(t,e,s){return[t[0]+s*(e[0]-t[0]),t[1]+s*(e[1]-t[1]),t[2]+s*(e[2]-t[2])]}static LerpArrayToRef(t,e,s,r){r[0]=t[0]+s*(e[0]-t[0]),r[1]=t[1]+s*(e[1]-t[1]),r[2]=t[2]+s*(e[2]-t[2])}static LerpArrayInPlace(t,e,s){t[0]+=s*(e[0]-t[0]),t[1]+=s*(e[1]-t[1]),t[2]+=s*(e[2]-t[2])}static Negate(t){return{x:-t.x,y:-t.y,z:-t.z}}static NegateToRef(t,e){e.x=-t.x,e.y=-t.y,e.z=-t.z}static NegateInPlace(t){t.x=-t.x,t.y=-t.y,t.z=-t.z}static NegateArray(t){return[-t[0],-t[1],-t[2]]}static NegateArrayToRef(t,e){e[0]=-t[0],e[1]=-t[1],e[2]=-t[2]}static NegateArrayInPlace(t){t[0]=-t[0],t[1]=-t[1],t[2]=-t[2]}static Equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}static EqualsArray(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}static Clone(t){return{x:t.x,y:t.y,z:t.z}}static CloneArray(t){return[t[0],t[1],t[2]]}static Copy(t,e){return t.x=e.x,t.y=e.y,t.z=e.z,t}static CopyArray(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}static CopyFromArray(t,e){return t.x=e[0],t.y=e[1],t.z=e[2],t}static CopyIntoArray(t,e){return t[0]=e.x,t[1]=e.y,t[2]=e.z,t}static ToArray(t){return[t.x,t.y,t.z]}static FromArray(t){return new a(t[0],t[1],t[2])}constructor(t,e,s){this.x=t,this.y=e,this.z=s}}},54966:(t,e,s)=>{s.d(e,{E:()=>o,z:()=>d});var r=s(81863),i=s(88224),n=s(97123);let a=0;class o{static INTERNAL_CODE="__internal__";static _tasks=new Map;static _waiting=new Map;static getTasks(t){return this._tasks.get(t)||!1}static isInternal(t){return!!Array.isArray(t)&&t[0]==o.INTERNAL_CODE&&"number"==typeof t[1]&&!!c[t[1]]}static getInternal(t){return!!c[t[1]]&&c[t[1]]}static runInternal(t,e,s){const r=this.getInternal(t);r&&r(t,e,s)}static getPromiseId(){return a++,a}static addPromiseTakss(t,e,s){let r=this._waiting.get(t);r||(r=new Map,this._waiting.set(t,r)),r.set(e,s)}static completePromiseTasks(t,e,s){let r=this._waiting.get(t);if(!r)return;const i=r.get(e);r.delete(e),i&&i(s)}}const c={[r.g.connectPort]:(t,e,s)=>{const r=t[2],n=r[0],a=r[1];let o;if(o="browser"==i.Q.environment?s.ports[0]:r[2],"worker"==a){const t=i.Q.getThread(n);t&&t.setPort(o)}if("worker"!=a){const t=i.Q.getThreadPool(a);t&&t.addPort(o)}},[r.g.setReady]:(t,e)=>{const s=t[2];n.j.readySet.add(e),e.name=s[0],e.index=s[1]},[r.g.runTask]:async(t,e,s)=>{const r=t[2],n=r[0],a=o.getTasks(n);if(!a)return void console.warn(`Tried running task ${n} | Thread ${i.Q.threadName} | Origin Thread ${e.name}`);const c=r[1],h=a(r[2],e,s);if(c<0)return;let u=null;u=h instanceof Promise?await h:h;let l=null,y=null;Array.isArray(u)&&(l=u[0],y=u[1]),d.completeTasks[2][0]=n,d.completeTasks[2][1]=c,d.completeTasks[2][2]=l,e.sendMessage(d.completeTasks,y),d.completeTasks[2][2]=null},[r.g.completeTasks]:(t,e)=>{const s=t[2],r=s[0],i=s[1],n=s[2];o.completePromiseTasks(r,i,n)},[r.g.checkTasks]:(t,e)=>{const s=t[2];d.cehckTasksResult[2][0]=!!o.getTasks(s[0]),d.cehckTasksResult[2][1]=s[1],e.sendMessage(d.cehckTasksResult)},[r.g.checkTasksResult]:t=>{const e=t[2][0],s=t[2][1];o.completePromiseTasks("tasks-check",s,e)}},d={runTask:[o.INTERNAL_CODE,r.g.runTask,["",0,null]],completeTasks:[o.INTERNAL_CODE,r.g.completeTasks,["",0,null]],checkTasks:[o.INTERNAL_CODE,r.g.checkTasks,["",0]],cehckTasksResult:[o.INTERNAL_CODE,r.g.checkTasksResult,[!1,0]]}},81863:(t,e,s)=>{var r;s.d(e,{g:()=>r}),function(t){t[t.setReady=0]="setReady",t[t.connectPort=1]="connectPort",t[t.runTask=2]="runTask",t[t.completeTasks=3]="completeTasks",t[t.checkTasks=4]="checkTasks",t[t.checkTasksResult=5]="checkTasksResult"}(r||(r={}))},88224:(t,e,s)=>{s.d(e,{Q:()=>o});var r=s(97123),i=s(50413),n=s(54966);let a=!1;class o{static threadNumber=0;static threadName="unamed-threadcomm-thread";static environment="browser";static _threads=new Map;static _threadPools=new Map;static parent=new r.j("parent",0);static get isInitalized(){return a}static async init(t,e,s="window"){this.threadName=t,this.parent.name=s,this.parent.setPort(e),a=!0,this.addThread(this.parent)}static addThread(t){this._threads.set(t.name,t)}static createThread(t,e={}){const s=Object.assign(new r.j(t,0),e);return this._threads.set(t,s),s}static createThreadPool(t){const e=new i.p(t);return this._threadPools.set(t,e),e}static getThread(t){return this._threads.get(t)||null}static getThreadPool(t){return this._threadPools.get(t)||null}static registerTask(t,e){n.E._tasks.set(t,e)}}"undefined"!=typeof process&&"undefined"==typeof Worker&&"undefined"==typeof window&&(o.environment="node")},25701:(t,e,s)=>{s.d(e,{QK:()=>r.Q,jV:()=>i.j,pX:()=>n.p});var r=s(88224),i=s(97123),n=s(50413)},46498:(t,e,s)=>{s.d(e,{A:()=>l});var r=s(25701),i=s(22879),n=s(24873),a=s(1772),o=s(24653),c=s(71657),d=s(40210),h=s(47464),u=s(86763);function l(t){r.QK.registerTask("sync-data",(e=>{c.i.syncSettings(e.settings),d.x.setPalette(e.voxels.materials.palette),i.O.loadIn(e.voxels.data.palette,e.voxels.data.nameToIdMap,e.voxels.data.idToNameMap);const s=a.V.stringMaps.getSegment("voxel");for(const t in e.voxels.data.stringMaps)s.add(t,e.voxels.data.stringMaps[t]);const r=a.V.objectMaps.getSegment("voxel");for(const t in e.voxels.data.objectMaps)r.add(t,e.voxels.data.objectMaps[t]);o.E.init(e.voxels.data.struct),o.E.sync(e.voxels.data.index),n.s.setPalette(e.voxels.substances.palette);const l=a.V.stringMaps.getSegment("substance");for(const t in e.voxels.substances.stringMaps)l.add(t,e.voxels.substances.stringMaps[t]);const y=a.V.objectMaps.getSegment("substance");for(const t in e.voxels.substances.objectMaps)y.add(t,e.voxels.substances.objectMaps[t]);u.O.init(e.voxels.substances.struct),h.wn.StateStruct.init(e.worldData.sectionStruct),h.hz.StateStruct.init(e.worldData.sectorStruct),t.onSync(e)}))}},82683:(t,e,s)=>{s.d(e,{Q:()=>i});var r=s(25701);class i{threadMap=new Map;_threads=[];constructor(){self.addEventListener("beforeunload",(()=>{for(const t of this._threads)t instanceof r.pX&&t.destroyAll(),t instanceof r.jV&&t.destroy()}))}setThreadPort(t,e){const s=this.getThread(t);if(s instanceof r.pX){if(!Array.isArray(e))throw new Error("Thread is a pool and needs an array of ports");for(const t of e)s.addPort(t)}else if(s instanceof r.jV){if(Array.isArray(e))throw new Error("Thread is a single thread and needs one port.");s.setPort(e)}}addThread(t){this.threadMap.set(t.name,t),this._threads.push(t)}getThread(t){const e=this.threadMap.get(t);if(!e)throw new Error(`Thread with id ${t} does not exists`);return e}}},98720:(t,e,s)=>{s.d(e,{s:()=>r});class r{}},1772:(t,e,s)=>{s.d(e,{V:()=>i});var r=s(88445);class i{static stringMaps=new r.i;static objectMaps=new r.i}i.stringMaps.addSegment("voxel"),i.objectMaps.addSegment("voxel"),i.stringMaps.addSegment("substance"),i.objectMaps.addSegment("substance")},88445:(t,e,s)=>{s.d(e,{i:()=>n});const r=t=>`entry-synced-${t}`;class i extends EventTarget{entries=new Map;onEntryAdded(t,e){const s=r(t),i=()=>{e(this.entries.get(t)),this.removeEventListener(s,i)};this.addEventListener(s,i)}add(t,e){this.entries.set(t,e),this.dispatchEvent(new Event(r(t)))}get(t){return this.entries.get(t)}}class n{segments=new Map;addSegment(t){if(this.segments.has(t))return this.segments.get(t);const e=new i;return this.segments.set(t,e),e}getSegment(t){const e=this.segments.get(t);if(!e)throw new Error(`Segment with id ${t} does not exist`);return e}sync(t,e,s){this.addSegment(t).add(e,s)}get(t,e,s){const r=this.segments.get(t);if(!r)return null;const i=r.get(e);return i?i[s]:null}}},17480:(t,e,s)=>{s.d(e,{BN:()=>a,WS:()=>i,pN:()=>n});var r=s(99638);function i(t,e,s,r,i,n,a=[0,0,0]){return a[0]=t>>r<<r,a[1]=e>>i<<i,a[2]=s>>n<<n,a}function n(t,e,s,i,n,a,o=r.Az.Create()){return o.x=t>>i<<i,o.y=e>>n<<n,o.z=s>>a<<a,o}function a(t,e,s,r,i,n){return s+n*(t+r*e)}},71657:(t,e,s)=>{s.d(e,{i:()=>o});var r=s(30097),i=s(23917),n=s(82339);class a extends n.m{enviorment=i.O.isNode()?"node":"browser";settings=new r.i;getSettings(){return this.settings}syncSettings(t){for(const e of Object.keys(t)){if(e.includes("__"))throw new Error("Can not include properties with multpile underscores.");if(void 0!==this.settings[e])for(const s of Object.keys(t[e])){if(s.includes("__"))throw new Error("Can not include properties with multpile underscores.");void 0!==this.settings[e][s]&&(this.settings[e][s]=t[e][s])}}this.dispatch("synced",{settings:this})}getSettingsCopy(){return JSON.parse(JSON.stringify(this.settings))}doSunPropagation(){return 1==this.settings.lighting.autoSunLight}doRGBPropagation(){return 1==this.settings.lighting.autoRGBLight}doLight(){return this.doRGBPropagation()||this.doSunPropagation()}doFlow(){return this.settings.flow.enable}isClient(){return"browser"!=this.enviorment}}const o=new a},30097:(t,e,s)=>{s.d(e,{i:()=>r});class r{rendererSettings={mode:"webgl"};textures={animationTime:20,textureSize:16,mipMapSizes:[16,12,8,4]};updating={autoRebuild:!0};world={maxX:Number.MAX_SAFE_INTEGER,minX:-Number.MAX_SAFE_INTEGER,maxZ:Number.MAX_SAFE_INTEGER,minZ:-Number.MAX_SAFE_INTEGER,maxY:256,minY:0};sectors={sectorXPow2:4,sectorYPow2:8,sectorZPow2:4};sections={autoHeightMap:!0,sectionXPow2:4,sectionYPow2:4,sectionZPow2:4};voxels={doColors:!0};flow={enable:!0,baseFlowLimit:200};lighting={doAO:!0,doSunLight:!0,doRGBLight:!0,autoRGBLight:!0,autoSunLight:!0}}},15620:(t,e,s)=>{s.d(e,{j:()=>o});var r=s(24873),i=s(1772),n=s(54031),a=s(86763);class o{static tags=a.O;substanceTagIndex=0;setSubstanceFromString(t){return this.substanceTagIndex=r.s.id.numberFromString(t),a.O.setSubstance(this.substanceTagIndex),this}setSubstance(t){return this.substanceTagIndex=t,a.O.setSubstance(this.substanceTagIndex),this}getSubstanceStringId(){return r.s.id.stringFromNumber(this.substanceTagIndex)}isSolid(){return 1==a.O.instance[n.W.isSolid]}isLiquid(){return 1==a.O.instance[n.W.isLiquid]}isWindAffected(){return 1==a.O.instance[n.W.isWindAffected]}getParent(){return i.V.stringMaps.get("substance",n.W.parent,a.O.instance[n.W.parent])}getFlowRate(){return a.O.instance[n.W.flowRate]}}},23917:(t,e,s)=>{s.d(e,{O:()=>r});class r{static isNode(){return"undefined"!=typeof process&&process.versions&&!!process.versions.node}static isBrowser(){return!this.isNode()}}},46300:(t,e,s)=>{s.d(e,{N:()=>r});class r{_count=0;_palette=[];_map={};constructor(t){if(t){const e=t.length;for(let s=0;s<e;s++)this.register(t[s])}}get size(){return this._count}register(t){const e=this._count;return this._count++,this._palette[e]=t,this._map[t]=e,e}get(){return this._palette}getMap(){return this._map}isRegistered(t){return void 0!==this._map[t]}getNumberId(t){return this._map[t]}getStringId(t){return this._palette[t]}}},82339:(t,e,s)=>{s.d(e,{m:()=>r});class r extends EventTarget{addEventListener(t,e,s){super.addEventListener(t,e,s)}removeEventListener(t,e){super.removeEventListener(t,e)}dispatch(t,e){return super.dispatchEvent(new CustomEvent(t,{detail:e})),!0}}},17859:(t,e,s)=>{s.d(e,{S:()=>y});var r=s(26704),i=s(3338),n=s(1772),a=s(24653),o=s(13935),c=s(65881),d=s(22879),h=s(24873),u=s(40210),l=s(15620);class y{_loadedId=0;id=0;secondaryId=0;__struct;__secondary=!1;_index=0;_lightData=new i.$;_substanceData=new l.j;process(){this.__struct||(this.__struct=a.E.clone()),this.id=this.ids[this._index],this.secondaryId=this.secondary[this._index],this.secondaryId>1?this.id=this.secondaryId:this.secondaryId=0,this.__struct.setIndex(a.E.voxelIndex[this.id]),this._loadedId=this.getId()}setSecondary(t){return this.__secondary=t,t?this.__struct.setIndex(a.E.voxelIndex[this.secondaryId]):this.__struct.setIndex(a.E.voxelIndex[this.id]),this._loadedId=this.getId(),this}getRenderedMaterial(){return this.__struct[r.y.renderedMaterial]}getRenderedMaterialStringId(){return u.x.id.stringFromNumber(this.__struct[r.y.renderedMaterial])}getMaterial(){return this.__struct[r.y.voxelMaterial]}getMaterialStringId(){return u.x.id.stringFromNumber(this.__struct[r.y.voxelMaterial])}checkCollisions(){return 1==this.__struct[r.y.checkCollisions]}getCollider(){return this.__struct[r.y.colliderID]}getColliderStringId(){return n.V.stringMaps.get("voxel",r.y.colliderID,this.__struct[r.y.colliderID])}getSubstance(){return this.__struct[r.y.substance]}getSubstanceData(){return this._substanceData.setSubstance(this.getSubstance())}getSubstanceStringId(){return h.s.id.stringFromNumber(this.getSubstance())}isOpaque(){return 0==this.__struct[r.y.isTransparent]}getMod(){return this.mod[this._index]}setMod(t){return this.mod[this._index]=t,this}getLevel(){return o.R.getLevel(this.level[this._index])}setLevel(t){return this.level[this._index]=o.R.setLevel(this.level[this._index],t),this}getLevelState(){return o.R.getLevelState(this.level[this._index])}setLevelState(t){return this.level[this._index]=o.R.setLevelState(this.level[this._index],t),this}getState(){return this.state[this._index]}setState(t){return this.state[this._index]=t,this}hasSecondaryVoxel(){return this.secondaryId>1}canHaveSecondaryVoxel(){return 1==this.__struct[r.y.canHaveSecondary]}hasRGBLight(){const t=this.getLight();return this._lightData.hasRGBLight(t)}hasSunLight(){const t=this.getLight();return this._lightData.hasSunLight(t)}getLight(){if(0==this._loadedId)return this.light[this._index];const t=this.__struct[r.y.lightValue];return this.isOpaque()?this.isLightSource()&&t?t:-1:this.isLightSource()&&t?this._lightData.mixLight(this.light[this._index],t):this.light[this._index]}setLight(t){return this.light[this._index]=t,this}isLightSource(){return!(this._loadedId<=0)&&(c.B.isRegistered(this._loadedId,r.y.isLightSource)?!0===c.B.getValue(this._loadedId,r.y.isLightSource,this.getState()):1==this.__struct[r.y.isLightSource])}getLightSourceValue(){return this._loadedId<=0?0:this.__struct[r.y.lightValue]}noAO(){return!(this._loadedId<=0)&&1==this.__struct[r.y.noAO]}isRenderable(){return this.id>0||!!(this.canHaveSecondaryVoxel()&&this.secondary[this._index]>0)}isAir(){return 0==this.ids[this._index]}setAir(){return this.ids[0]=0,this}getId(){return this.__secondary?this.secondaryId:this.id}setId(t){return this.__secondary?(this.secondary[this._index]=t,this):(this.ids[this._index]=t,this)}setStringId(t){return this.setId(d.O.ids.getNumberId(t))}getStringId(){return this.__secondary?d.O.ids.getStringId(this.secondaryId):d.O.ids.getStringId(this.id)}setName(t){this.setStringId(d.O.name.getId(t))}getName(){return this.getStringId()}isSameVoxel(t){return this.getId()==t.getId()}copy(t){return this.ids[this._index]=t.ids[t._index],this.light[this._index]=t.light[t._index],this.level[this._index]=t.level[t._index],this.state[this._index]=t.state[t._index],this.mod[this._index]=t.mod[t._index],this.secondary[this._index]=t.secondary[t._index],this}copyRaw(t){return this.ids[this._index]=t[0],this.light[this._index]=t[1],this.level[this._index]=t[2],this.state[this._index]=t[3],this.secondary[this._index]=t[4],this.mod[this._index]=t[5],this}getRaw(){return[this.ids[this._index],this.light[this._index],this.level[this._index],this.state[this._index],this.mod[this._index],this.secondary[this._index]]}getRawToRef(t){return t[0]=this.ids[this._index],t[1]=this.light[this._index],t[2]=this.level[this._index],t[3]=this.state[this._index],t[4]=this.mod[this._index],t[5]=this.secondary[this._index],t}}},3338:(t,e,s)=>{s.d(e,{$:()=>r});class r{_lightValues=new Uint16Array([0,0,0,0]);sumRGB(t){return this.getR(t)+this.getG(t)+this.getB(t)}getS(t){return 15&t}getR(t){return(240&t)>>4}getG(t){return(3840&t)>>8}getB(t){return(61440&t)>>12}setS(t,e){return-16&e|t}setR(t,e){return-241&e|t<<4}setG(t,e){return-3841&e|t<<8}setB(t,e){return-61441&e|t<<12}removeS(t){return this.setS(0,t)}hasRGBLight(t){return!(t<=0)&&(this.getR(t)>0||this.getG(t)>0||this.getB(t)>0)}hasSunLight(t){return!(t<=0)&&this.getS(t)>0}mixLight(t,e){const s=this.getS(t),r=this.getS(e),i=s<r?r:s,n=this.getR(t),a=this.getR(e),o=n<a?a:n,c=this.getG(t),d=this.getG(e),h=c<d?d:c,u=this.getB(t),l=this.getB(e),y=u<l?l:u;let g=this.setS(i,0);return g=this.setR(o,g),g=this.setG(h,g),g=this.setB(y,g),g}getRGB(t){return t<0?0:(65520&t)>>4}setRGB(t,e){return e<0?0:-65521&e|t<<4}decodeLightFromVoxelData(t){return 65535&t}encodeLightIntoVoxelData(t,e){return-65536&t|e}setLightValues(t){let e=this.setS(t[0],0);return e=this.setR(t[1],e),e=this.setG(t[2],e),this.setB(t[3],e)}getLightValues(t){return this._lightValues[0]=this.getS(t),this._lightValues[1]=this.getR(t),this._lightValues[2]=this.getG(t),this._lightValues[3]=this.getB(t),this._lightValues}getLightValuesToRef(t,e){return e[0]=this.getS(t),e[1]=this.getR(t),e[2]=this.getG(t),e[3]=this.getB(t),e}addLightValues(t,e){return this._lightValues[0]=this.getS(t)+this.getS(e),this._lightValues[1]=this.getR(t)+this.getR(e),this._lightValues[2]=this.getG(t)+this.getG(e),this._lightValues[3]=this.getB(t)+this.getB(e),this._lightValues[0]>15&&(this._lightValues[0]=15),this._lightValues[1]>15&&(this._lightValues[1]=15),this._lightValues[2]>15&&(this._lightValues[2]=15),this._lightValues[3]>15&&(this._lightValues[3]=15),this.setLightValues(this._lightValues)}divideLightValue(t,e){return this._lightValues[0]=Math.ceil(this.getS(t)/e),this._lightValues[1]=Math.ceil(this.getR(t)/e),this._lightValues[2]=Math.ceil(this.getG(t)/e),this._lightValues[3]=Math.ceil(this.getB(t)/e),this.setLightValues(this._lightValues)}}},40210:(t,e,s)=>{s.d(e,{x:()=>i});var r=s(46300);class i{static palette;static setPalette(t){this.palette=new r.N(t)}static id={stringFromNumber:t=>this.palette.getStringId(t),numberFromString:t=>this.palette.getNumberId(t)}}},24873:(t,e,s)=>{s.d(e,{s:()=>i});var r=s(46300);class i{static palette;static setPalette(t){this.palette=new r.N(t)}static id={stringFromNumber:t=>this.palette.getStringId(t),numberFromString:t=>this.palette.getNumberId(t)}}},22879:(t,e,s)=>{s.d(e,{O:()=>i});var r=s(46300);class i{static _nameToIdMap=new Map;static _idToNameMap=new Map;static ids;static loadIn(t,e,s){this.ids=new r.N(t),this._nameToIdMap=new Map(Object.entries(e)),this._idToNameMap=new Map(Object.entries(s))}static name={getId:t=>this._nameToIdMap.get(t),getName:t=>this._idToNameMap.get(t)}}},57309:(t,e,s)=>{s.d(e,{n:()=>i});var r=s(59457);class i{nodeMap=new Map;nodes=[];constructor(t){for(const e of t)if("binary"==e.type){const t=new r.f(e);this.nodes.push(t),this.nodeMap.set(e.id,t)}}_value=0;readString(t){if("*"==t)return 0;const e=t.split(",");let s=0;for(const t of e){const[e,r]=t.split("=");if("*"==r)continue;const i=this.nodeMap.get(e);if(i)if(i.valuePalette){const t=i.valuePalette.getNumberId(r);if(void 0===t)throw new Error(`Binary schema string node value with id ${r} does not exist.`);s=i.setValue(s,t)}else s=i.setValue(s,Number(r))}return s}fromStateObject(t){let e=0;for(let s=0;s<t.length;s+=2){const r=t[s];if("string"!=typeof r)continue;const i=t[s+1],n=this.nodeMap.get(r);if(n)if("string"!=typeof i)e=n.setValue(e,i);else{if(!n.valuePalette)continue;e=n.setValue(e,n.valuePalette.getNumberId(i)||0)}}return e}getStateObject(t){const e=[];for(const s of this.nodes)s.valuePalette?e.push(s.id,s.valuePalette.getStringId(s.getValue(t))):e.push(s.id,s.getValue(t));return e}compareString(t,e){if("*"==t)return!0;const s=t.split(",");for(const t of s){const[s,r]=t.split("=");if("*"==r)continue;const i=this.nodeMap.get(s);if(i)if(i.valuePalette){const t=i.valuePalette.getNumberId(r);if(void 0===t)throw new Error(`Binary schema string node value  with id ${s} does not exist.`);if(i.getValue(e)!==t)return!1}else if(i.getValue(e)!==Number(r))return!1}return!0}startEncoding(t=0){return this._value=t,this}getNmber(t){const e=this.nodeMap.get(t);if(!e)throw new Error(`Node with ${t} does not exist.`);return e.getValue(this._value)}getValue(t){const e=this.nodeMap.get(t);if(!e)throw new Error(`Node with ${t} does not exist.`);if(!e.valuePalette)throw new Error(`Node with ${t} does not have a value palette.`);return e.valuePalette.getStringId(e.getValue(this._value))}setNumber(t,e){const s=this.nodeMap.get(t);if(!s)throw new Error(`Node with ${t} does not exist.`);return this._value=s.setValue(this._value,e),this}setValue(t,e){const s=this.nodeMap.get(t);if(!s)throw new Error(`Node with ${t} does not exist.`);if(!s.valuePalette)throw new Error(`Node with ${t} does not have a value palette.`);return this._value=s.setValue(this._value,s.valuePalette.getNumberId(e)),this}getEncoded(){return this._value}}},59457:(t,e,s)=>{s.d(e,{f:()=>i});var r=s(46300);class i{id;valuePalette;bitIndex=0;bitMask=0;constructor(t){this.id=t.id,this.bitIndex=t.index,this.bitMask=t.mask,t.valuePalette&&(this.valuePalette=new r.N(t.valuePalette))}getValue(t){return(t&this.bitMask<<this.bitIndex)>>this.bitIndex}setValue(t,e){return t&~(this.bitMask<<this.bitIndex)|(e&this.bitMask)<<this.bitIndex}}},48826:(t,e,s)=>{s.d(e,{u:()=>i});var r=s(90475);class i extends r.k{data;constructor(t,e){super(t),this.data=e}evulate(){const t=this.schema.position.x+this.data.direction[0],e=this.schema.position.y+this.data.direction[1],s=this.schema.position.z+this.data.direction[2],r=this.schema.dataCursor.getVoxel(t,e,s);return!!r&&this.schema.voxel.isSameVoxel(r)}}},90475:(t,e,s)=>{s.d(e,{k:()=>r});class r{schema;constructor(t){this.schema=t}}},85456:(t,e,s)=>{s.d(e,{i:()=>i});var r=s(48826);class i{schema;id;conditions=[];constructor(t,e){this.schema=t,this.id=e.id;for(const s of e.conditions)"same-voxel"==s.type&&this.conditions.push(new r.u(t,s))}getValue(){let t=1;const e=this.conditions.length;for(let s=0;s<e;s++)if(!this.conditions[s].evulate()){t=0;break}return t}}},40397:(t,e,s)=>{s.d(e,{X:()=>a});var r=s(85456),i=s(59457),n=s(99638);class a{nodes=[];position=n.Az.Create();voxel;dataCursor;constructor(t){for(const e of t)"binary"==e.type&&this.nodes.push(new i.f(e)),"relation"==e.type&&this.nodes.push(new r.i(this,e))}}},58912:(t,e,s)=>{s.d(e,{G:()=>r});class r{id;state;mod;constructor(t,e,s){this.id=t,this.state=e,this.mod=s}}},83841:(t,e,s)=>{s.d(e,{r:()=>n});var r=s(57309),i=s(58912);class n{static modelStaeBaseSchemaData=new Map;static modelStateSchemaData=new Map;static voxelModSchemaData=new Map;static modelStaeSchemas=new Map;static voxelModSchemas=new Map;static voxelModelMap=new Map;static voxelSchemas=new Map;static hasVoxelSchema(t){return this.voxelSchemas.has(t)}static getVoxelSchemas(t){if(this.voxelSchemas.has(t))return this.voxelSchemas.get(t);const e=this.voxelModelMap.get(t);if(!e)throw new Error(`Voxel ${t} is not registered`);let s=this.modelStaeSchemas.get(e);if(!s){const t=this.modelStateSchemaData.get(e);if(!t)throw new Error(`Model ${e} is not registered`);s=new r.n(t)}let n=this.voxelModSchemas.get(t);if(!n){const e=this.voxelModSchemaData.get(t);if(!e)throw new Error(`Voxel ${t} is not registered`);n=new r.n(e)}const a=new i.G(t,s,n);return this.voxelSchemas.set(t,a),a}static registerModel(t,e){const s=[];this.modelStaeBaseSchemaData.set(t,e);for(const t of e)"binary"==t.type&&s.push(t);this.modelStateSchemaData.set(t,s)}static registerVoxel(t,e,s){this.voxelModelMap.set(t,e);const r=[];for(const t of s)"binary"==t.type&&r.push(t);this.voxelModSchemaData.set(t,r)}}},30169:(t,e,s)=>{s.d(e,{z:()=>r});class r{schema;defaultValue;tree;startingIndex=0;constructor(t,e=0,s){this.schema=t,this.defaultValue=e,this.tree=s}getState(t){if(!this.tree.length)return this.defaultValue;let e=this.startingIndex,s=this.tree;for(;;){if(s=s[e][this.schema.nodes[e].getValue(t)],"number"==typeof s)return s;if(void 0===s)return-1;for(let t=0;t<s.length;t++)if(s[t]){e=t;break}if("number"==typeof s)return s}return-1}}},65881:(t,e,s)=>{s.d(e,{B:()=>o});var r=s(22879),i=s(40397),n=s(30169),a=s(83841);class o{static voxelTags=[];static toJSON(){const t=[];return this.voxelTags.forEach(((e,s)=>{t[s]=Object.fromEntries(Object.keys(e).map((t=>[t,{tree:e[t].tree.tree,treePalette:e[t].treePalette}])))})),t}static load(t){t.forEach(((t,e)=>{if(!t)return;const s=new i.X(a.r.modelStaeBaseSchemaData.get(a.r.voxelModelMap.get(r.O.ids.getStringId(e))));for(const r in t)this.register(e,r,s,t[r].tree,t[r].treePalette)}))}static register(t,e,s,r,i){let a=this.voxelTags[t];a||(a={},this.voxelTags[t]=a),a[e]={tree:new n.z(s,0,r),treePalette:i}}static isRegistered(t,e){return this.voxelTags[t]&&void 0!==this.voxelTags[t][e]}static getData(t,e){return this.voxelTags[t][e]}static getState(t,e,s){return this.voxelTags[t][e].tree.getState(s)}static getValue(t,e,s){return this.voxelTags[t][e].treePalette[this.voxelTags[t][e].tree.getState(s)]}}},86763:(t,e,s)=>{s.d(e,{O:()=>a});var r=s(54265),i=(s(54031),s(24873));const n=new r.jm("voxel-data");class a extends r.gZ{static instance;static init(t){n.init(t);const e=n.instantiate();this.initData=t,a.instance=e}static setSubstance(t){this.instance.setIndex("string"==typeof t?i.s.id.numberFromString(t):t)}static initData}},24653:(t,e,s)=>{s.d(e,{E:()=>a});var r=s(54265),i=(s(26704),s(22879));const n=new r.jm("voxel-data");class a extends r.gZ{static instance;static init(t){n.init(t);const e=n.instantiate();this.initData=t,a.instance=e}static clone(){return this.instance.createClone()}static sync(t){this.voxelIndex=t}static setVoxel(t){const e=this.voxelIndex[t];this.instance.setIndex(e)}static setStringVoxel(t){const e=this.voxelIndex[i.O.ids.getNumberId(t)];this.instance.setIndex(e)}static voxelIndex=new Uint16Array;static initData}},26704:(t,e,s)=>{var r;s.d(e,{y:()=>r}),function(t){t.substance="dve_substance",t.renderedMaterial="dve_rendered_material",t.voxelMaterial="dve_voxel_material",t.hardness="dve_hardness",t.colliderID="dve_collider_id",t.checkCollisions="dve_check_collisions",t.isLightSource="dve_is_light_source",t.noAO="dve_no_ao",t.isTransparent="dve_is_transparent",t.lightValue="dve_light_value",t.isRich="dve_is_rich",t.canHaveSecondary="dve_can_have_secondary"}(r||(r={}))},54031:(t,e,s)=>{var r;s.d(e,{W:()=>r}),function(t){t.parent="dve_parent_substance",t.isSolid="dve_is_solid",t.isTransparent="dve_is_transparent",t.isLiquid="dve_is_liquid",t.flowRate="dve_flow_rate",t.isWindAffected="dve_is_wind_affected"}(r||(r={}))},13935:(t,e,s)=>{var r;s.d(e,{R:()=>i}),function(t){t[t.Level=15]="Level",t[t.LevelState=48]="LevelState",t[t.ShapeState=65472]="ShapeState"}(r||(r={}));class i{static getLevel(t){return t&r.Level}static setLevel(t,e){return t&~r.Level|e}static getLevelState(t){return(t&r.LevelState)>>4}static setLevelState(t,e){return t&~r.LevelState|e<<4}static getShapeState(t){return(t&r.ShapeState)>>6}static setShapeState(t,e){return t&~r.ShapeState|e<<6}}},75025:(t,e,s)=>{s.d(e,{p:()=>d});var r=s(99638),i=s(69519),n=s(95027),a=s(98720);let o=[];const c=r.Az.Create();class d extends a.s{sectorCursors=new Map;origin={x:0,y:0,z:0};dimension="";setFocalPoint(t,e,s,r){const i=n.k.sector.getPosition(e,s,r,c);for(const[t,e]of this.sectorCursors)for(const[t,s]of e)o.push(s);this.sectorCursors.clear(),this.dimension=t,this.origin.x=i.x/n.k.sector.bounds.x,this.origin.y=i.y/n.k.sector.bounds.y,this.origin.z=i.z/n.k.sector.bounds.z}inBounds(t,e,s){return n.k.world.inBounds(t,e,s)}getSector(t,e,s){const r=n.k.sector.getPosition(t,e,s,c),a=r.x/n.k.sector.bounds.x-this.origin.x,d=r.z/n.k.sector.bounds.z-this.origin.z;let h=this.sectorCursors.get(a),u=h?.get(d);if(!u){if(u=o.length?o.shift():new i.j,!u.setSector(this.dimension,r.x,r.y,r.z))return null;h||(h=new Map,this.sectorCursors.set(a,h)),h.set(d,u)}return u}getVoxel(t,e,s){const r=this.getSector(t,e,s);return r?r.getVoxel(t,e,s):null}}},76447:(t,e,s)=>{s.d(e,{f:()=>r});class r{static CreateNew(t){return new r({id:t,sectors:new Map})}constructor(t){return Object.assign(this,t)}set(t,e){this.sectors.set(t,e)}delete(t){this.sectors.delete(t)}get(t){return this.sectors.get(t)}}},44575:(t,e,s)=>{s.d(e,{w:()=>c});var r=s(54265),i=s(95027),n=s(38717);function a(t){return t%2==0?t:t+1}const o=[0,0,0];class c{sector;index;static GetBufferSize(){const t=i.k.section.volumne;return a(a(c.StateStruct.structSize)+2*t+2*t+t+2*t+2*t+2*t)}static GetArrayStartIndex(t){return t*c.GetBufferSize()+n.h.GetHeaderSize()+a(c.StateStruct.structSize)}static CreateNew(t,e){const s=i.k.section.volumne;let r=this.GetArrayStartIndex(t);const n=new Uint16Array(e,r,s);r+=2*s;const a=new Uint16Array(e,r,s);r+=2*s;const o=new Uint16Array(e,r,s);r+=2*s;const c=new Uint16Array(e,r,s);r+=2*s;const d=new Uint16Array(e,r,s);r+=2*s;const h=new Uint8Array(e,r,s);return r+=s,{ids:n,light:a,level:h,state:o,mod:c,secondary:d}}static toObject(t,e,s){return new c(t,e,s)}static StateStruct=new r.jm("section-tags");sectionState;constructor(t,e,s){this.sector=t,this.index=e,this.sectionState=new DataView(t.buffer,e*c.GetBufferSize()+n.h.GetHeaderSize(),c.StateStruct.structSize),this.ids=s.ids,this.level=s.level,this.light=s.light,this.secondary=s.secondary,this.state=s.state,this.mod=s.mod}getPosition(){return o[0]=this.sector.position[0],o[1]=this.sector.position[1]+this.index*i.k.section.bounds.y,o[2]=this.sector.position[2],o}serialize(){return{ids:this.ids,light:this.light,level:this.level,secondary:this.secondary,state:this.state,mod:this.mod}}}},28135:(t,e,s)=>{var r;s.d(e,{g:()=>r}),function(t){t.minHeight="dve_min_height",t.maxHeight="dve_max_height",t.heightMap="dve_height_map",t.dirtyMap="dve_dirty_map",t.voxelIDSegment="dve_voxel_id",t.voxelLightSegment="dve_voxel_light",t.voxelStateSegment="dve_voxel_state",t.voxelSecondaryIDSegment="dve_voxel_secondary_id"}(r||(r={}))},47980:(t,e,s)=>{s.d(e,{w:()=>r.w});var r=s(44575)},38717:(t,e,s)=>{s.d(e,{h:()=>a});var r=s(54265),i=s(44575),n=s(95027);class a{static StateStruct=new r.jm("sector-tags");static GetHeaderSize(){return(t=a.StateStruct.structSize)%2==0?t:t+1;var t}static GetBufferSize(){const t=n.k.sector.bounds.y/n.k.section.bounds.y;return this.GetHeaderSize()+i.w.GetBufferSize()*t}static CreateNew(){const t=new SharedArrayBuffer(this.GetBufferSize());a.StateStruct.setBuffer(t),a.StateStruct.setProperty("dve_is_stored",0);const e=[],s=n.k.sector.bounds.y/n.k.section.bounds.y;for(let r=0;r<s;r++)e[r]=i.w.CreateNew(r,t);return{position:[0,0,0],buffer:t,sections:e}}sections=[];bufferView;sectorState;position;constructor(t){this.position=t.position,this.sectorState=new DataView(t.buffer),this.buffer=t.buffer,this.bufferView=new Uint8Array(t.buffer);for(let e=0;e<t.sections.length;e++)this.sections[e]=new i.w(this,e,t.sections[e])}getSection(t){const e=(t-this.position[1])/n.k.section.bounds.y;return this.sections[e]}toJSON(){const t=[];for(const e of this.sections)t.push(e.serialize());return{position:this.position,buffer:this.buffer,sections:t}}}},96715:(t,e,s)=>{var r;s.d(e,{U:()=>r}),function(t){t.SyncSector="sync-sector",t.UnSyncSector="unsync-sector",t.SyncDimension="sync-dimension",t.UnSyncDimension="unsync-dimension"}(r||(r={}))}}]);