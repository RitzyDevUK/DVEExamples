"use strict";(self.webpackChunkdivinecraft=self.webpackChunkdivinecraft||[]).push([[336],{35223:(t,e,s)=>{s(11628),s(31139),s(56956),s(80917)},31139:(t,e,s)=>{var r=s(14494),n=s(95873),i=s(45466),o=s(25424),a=s(95541);class d{static _mode="object";static _sharedMemory=!1;static _cobj={};static _parents=[];static _objArray=[];static _name="";static _length=0;static _objCount=0;static _inOject=!1;static _newTypedNode(t,e,s=0){return new i.R(t,e,s)}static _assign(t){"object"==this._mode||"json"==this._mode?Array.isArray(this._cobj)?this._cobj.push(t):this._cobj[this._name]=t:Array.isArray(this._cobj.value)?this._cobj.value.push(t):this._cobj.value[this._name]=t}static markFunctions={[r.A.Name]:(t,e)=>{this._name="";const s=Number(o.n[n.QI.Uint8](t,e+1));for(let r=e+=2*n.bI.Uint8;r<e+s;r++)this._name+=String.fromCharCode(o.n[n.QI.Uint8](t,r));return e+s*n.bI.Uint8},[r.A.Object]:(t,e)=>{let s;return s="object"==this._mode?{}:this._newTypedNode(r.A.Object,{}),0!=this._objCount&&(this._assign(s),this._parents.push(this._cobj)),this._objCount++,this._cobj=s,n.bI.Uint8+e},[r.A.ObjectEnd]:(t,e)=>(this._parents.length>0&&(this._cobj=this._parents.pop()),n.bI.Uint8+e),[r.A.Array]:(t,e)=>{let s;return s="object"==this._mode?[]:this._newTypedNode(r.A.Array,[]),0!=this._objCount&&(this._assign(s),this._parents.push(this._cobj)),this._objCount++,this._cobj=s,n.bI.Uint8+e},[r.A.ArrayEnd]:(t,e)=>(this._parents.length>0&&(this._cobj=this._parents.pop()),n.bI.Uint8+e),[r.A.Boolean]:(t,e)=>{const s=o.n[n.QI.Uint8](t,e+1);return"type-node"!=this._mode?this._assign(!s):this._assign(this._newTypedNode(r.A.Boolean,!s)),n.bI.Uint8+n.bI.Int8+e},[r.A.Undefined]:(t,e)=>("type-node"!=this._mode?this._assign(void 0):this._assign(this._newTypedNode(r.A.Undefined,void 0)),n.bI.Uint8+e),[r.A.Int8]:(t,e)=>{const s=o.n[n.QI.Int8](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.Int8,s)),n.bI.Uint8+n.bI.Int8+e},[r.A.Uint8]:(t,e)=>{const s=o.n[n.QI.Uint8](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.Uint8,s)),n.bI.Uint8+n.bI.Uint8+e},[r.A.Uint8Clamped]:(t,e)=>{const s=o.n[n.QI.Uint8](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.Uint8,s)),n.bI.Uint8+n.bI.Uint8+e},[r.A.Int16]:(t,e)=>{const s=o.n[n.QI.Int16](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.Int16,s)),n.bI.Uint8+n.bI.Int16+e},[r.A.Uint16]:(t,e)=>{const s=o.n[n.QI.Uint16](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.Uint16,s)),n.bI.Uint8+n.bI.Uint16+e},[r.A.Float32]:(t,e)=>{const s=o.n[n.QI.Float32](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.Float32,s)),n.bI.Uint8+n.bI.Float32+e},[r.A.Int32]:(t,e)=>{const s=o.n[n.QI.Int32](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.Int32,s)),n.bI.Uint8+n.bI.Int32+e},[r.A.Uint32]:(t,e)=>{const s=o.n[n.QI.Uint32](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.Uint32,s)),n.bI.Uint8+n.bI.Uint8+n.bI.Uint32+e+1},[r.A.Float64]:(t,e)=>{const s=o.n[n.QI.Float64](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.Float64,s)),n.bI.Uint8+n.bI.Float64+e},[r.A.BigInt]:(t,e)=>{const s=o.n[n.QI.BigInt](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.BigInt,s)),n.bI.Uint8+n.bI.BigInt+e},[r.A.BigUint]:(t,e)=>{const s=o.n[n.QI.BigUint](t,e+1);return"type-node"!=this._mode?this._assign(s):this._assign(this._newTypedNode(r.A.BigUint,s)),n.bI.Uint8+n.bI.BigUint+e},[r.A.String]:(t,e)=>{const s=o.n[n.QI.Uint32](t,e+1);let i="";for(let r=e+=n.bI.Uint32+n.bI.Uint8;r<e+s;r++)i+=String.fromCharCode(o.n[n.QI.Uint8](t,r));return"type-node"!=this._mode?this._assign(i):this._assign(this._newTypedNode(r.A.String,i)),e+s*n.bI.Uint8},[r.A.TypedArray]:(t,e)=>{const s=o.n[n.QI.Uint8](t,e+1);if(void 0===s)throw new Error(`Not a valid type for a typed array ${s}`);const i=o.n[n.QI.Uint32](t,e+2);let d;e+=2*n.bI.Uint8+n.bI.Uint32,d="json"==this._mode?[]:a.I[s](i,this._sharedMemory);const h=o.n[s];for(let r=0;r<i;r++)d[r]=h(t,e),e+=n.Yd[s];return"type-node"!=this._mode?this._assign(d):this._assign(this._newTypedNode(r.A.TypedArray,d,s)),e},[r.A.Blob]:(t,e)=>("type-node"!=this._mode?this._assign(Blob):this._assign(this._newTypedNode(r.A.Blob,void 0)),n.bI.Uint8+e),[r.A.ArrayBuffer]:(t,e)=>{const s=o.n[n.QI.Uint32](t,e+1);e+=n.bI.Uint8+n.bI.Uint32;const i=new Uint8Array(this._sharedMemory?new SharedArrayBuffer(s):new ArrayBuffer(s));for(let r=0;r<s;r++)i[r]=o.n[n.QI.Uint8](t,e),e+=n.QI.Uint8;return"type-node"!=this._mode?this._assign(i.buffer):this._assign(this._newTypedNode(r.A.ArrayBuffer,i.buffer)),e},[r.A.Json]:(t,e)=>{const s=o.n[n.QI.Uint32](t,e+1);let i="";for(let r=e+=n.bI.Float32+n.bI.Uint8;r<e+s;r++)i+=String.fromCharCode(o.n[n.QI.Uint8](t,r));const a=JSON.parse(i);return"type-node"!=this._mode?this._assign(a):this._assign(this._newTypedNode(r.A.Json,a)),e+s*n.bI.Uint8}};static setUseSharedMemory(t){this._sharedMemory=t}static toObject(t,e=0,s=0){let i;this._mode="object",i=0==s?t.byteLength:s;const a=new DataView(t);this._objCount=0;let d=e,h=r.A.Object;for(;d<i;)h=o.n[n.QI.Uint8](a,d),d=this.markFunctions[h](a,d);return this._cobj}static toJSON(t,e=0,s=0){let i;this._mode="json",i=0==s?t.byteLength:s;const a=new DataView(t);this._objCount=0;let d=e,h=r.A.Object;for(;d<i;)h=o.n[n.QI.Uint8](a,d),d=this.markFunctions[h](a,d);return this._cobj}static toTypedNodes(t,e=0,s=0){let i;this._mode="type-node",i=0==s?t.byteLength:s,this._mode="object";const a=new DataView(t);this._objCount=0;let d=e,h=r.A.Object;for(;d<i;)h=o.n[n.QI.Uint8](a,d),d=this.markFunctions[h](a,d);return this._cobj}}},56956:(t,e,s)=>{s(49031),s(45466),s(11628),s(80917)},80917:(t,e,s)=>{s(14494),s(95873),s(77288)},11628:(t,e,s)=>{s(45466),s(14494)},42577:(t,e,s)=>{s(11628),s(45466),s(35223)},77288:(t,e,s)=>{s(95873),s(96692),new DataView(new ArrayBuffer(8))},49031:(t,e,s)=>{s.d(e,{Q:()=>n});var r=s(95873);const n={[r.QI.Int8]:Int8Array,[r.QI.Uint8]:Uint8Array,[r.QI.Uint8Clamped]:Uint8ClampedArray,[r.QI.Int16]:Int16Array,[r.QI.Uint16]:Uint16Array,[r.QI.Float32]:Float32Array,[r.QI.Int32]:Int32Array,[r.QI.Uint32]:Uint32Array,[r.QI.Float64]:Float64Array,[r.QI.BigInt]:BigInt64Array,[r.QI.BigUint]:BigUint64Array};new Map([[Int8Array,r.QI.Int8],[Uint8Array,r.QI.Uint8],[Uint8ClampedArray,r.QI.Uint8Clamped],[Int16Array,r.QI.Int16],[Uint16Array,r.QI.Uint16],[Int32Array,r.QI.Int32],[Uint32Array,r.QI.Uint32],[Float32Array,r.QI.Float32],[Float64Array,r.QI.Float64],[BigInt64Array,r.QI.BigInt],[BigUint64Array,r.QI.BigUint]])},54265:(t,e,s)=>{s.d(e,{gZ:()=>r.gZ,jm:()=>r.jm}),s(42577);var r=s(10379);s(95873),s(79418)},29458:(t,e,s)=>{var r,n;!function(t){t.North="north",t.South="south",t.West="west",t.East="east",t.NorthEast="north-east",t.NorthWest="north-west",t.SouthEast="south-east",t.SouthWest="south-west"}(r||(r={})),function(t){t[t.North=0]="North",t[t.NorthEast=Math.PI/4]="NorthEast",t[t.East=Math.PI/2]="East",t[t.SouthEast=3*Math.PI/4]="SouthEast",t[t.South=Math.PI]="South",t[t.SouthWest=5*Math.PI/4]="SouthWest",t[t.West=3*Math.PI/2]="West",t[t.NorthWest=7*Math.PI/4]="NorthWest"}(n||(n={})),r.North,n.North,r.South,n.South,r.West,n.West,r.East,n.East,r.NorthEast,n.NorthEast,r.NorthWest,n.NorthWest,r.SouthEast,n.SouthEast,r.SouthWest,n.SouthWest},38869:(t,e,s)=>{s.d(e,{Az:()=>r.A});var r=s(45741)},93905:(t,e,s)=>{s.d(e,{N:()=>h});var r=s(82180),n=s(45601),i=s(31058),o=s(59252);const a=[0,0];class d{componentAdded=new r.c;componentRemoved=new r.c;nodeAdded=new r.c;nodeRemoved=new r.c}class h{graph;numberTypeId;_freeSlots=[];_node=[];_disposed=[];_data=[];schemaArray;proto;observers=new d;_nodeCursor;_componentCursor;constructor(t,e){this.graph=t,this.numberTypeId=e;const s=n.g.components.get(n.g.components.idPalette.getStringId(e));s.schema&&(this.schemaArray=s.schema.array),this.proto=s,this._nodeCursor=i.t.Get(),this._componentCursor=o.w.Get()}addComponent(t,e,s){let r=this._freeSlots.length?this._freeSlots.shift():this._node.length;return this._node[r]=t,this._disposed[r]=!1,this.schemaArray&&this.schemaArray.setData(r,e,s),a[0]=this.numberTypeId,a[1]=r,this.observers.componentAdded.notify(a),r}removeComponent(t){if(void 0===this._node[t])return null;a[0]=this.numberTypeId,a[1]=t,this.observers.componentRemoved.notify(a),this.observers.nodeRemoved.notify(this._node[t]),this._freeSlots.push(t);const e=this._node[t];return this._disposed[t]=!0,this._data[t]=void 0,this._node[t]=-1,this.schemaArray&&this.schemaArray.removeData(t),e}update(){const t=this.proto.update;if(t)for(let e=0;e<this._disposed.length;e++)this._disposed[e]||(this._componentCursor.setInstance(this._nodeCursor.setNode(this.graph,this._node[e]),this.numberTypeId,e),t(this._componentCursor))}init(t){const e=this.proto.init;return!!e&&(this._componentCursor.setInstance(this._nodeCursor.setNode(this.graph,this._node[t]),this.numberTypeId,t),e(this._componentCursor),!1)}}},59252:(t,e,s)=>{s.d(e,{w:()=>o});var r=s(45601),n=s(31058),i=s(62209);class o{static Get(){return i.u.componentCursor.get()||new o}static Retrun(t){return i.u.componentCursor.addItem(t)}get index(){return this._index}get type(){return r.g.components.idPalette.getStringId(this._type)}get shared(){return this.__proto.shared}schema;get data(){return this.arrays._data[this._index]}set data(t){this.arrays._data[this._index]=t}node;arrays;__proto;get typeId(){return this._type}_index=0;_type=0;constructor(){}setInstance(t,e,s){return this._index=s,this._type=e,this.node=t,this.__proto=r.g.components.items[this._type],this.arrays=t.graph._components[e],void 0!==this.arrays?.schemaArray?._data[s]&&(this.schema=this.arrays.schemaArray.createViewCursor(s),this.schema.setInstance(s)),this}get isDisposed(){return this.arrays._disposed[this._index]}dispose(){this.__proto.dispose&&this.__proto.dispose(this),this.arrays.removeComponent(this._index)}returnCursor(){return o.Retrun(this)}cloneCursor(t,e){const s=t||o.Get(),r=e||n.t.Get();return r.setNode(this.node.graph,this.node.index),s.setInstance(r,this.typeId,this._index),s}update(){this.__proto.update&&this.__proto.update(this)}}},61153:(t,e,s)=>{s.d(e,{F:()=>n});var r=s(45601);class n{_freeSlots=[];_type=[];_node=[];_state=[];_disposed=[];_data=[];schemaArray;numberTypeId;addContext(t,e,s,n,i=null){let o=this._freeSlots.length?this._freeSlots.shift():this._node.length;const a=r.g.contexts.get(t).schema;if(a){let e=this.schemaArray[t];e||(e=a.array,this.schemaArray[t]=e),e.setData(o,n)}return this._type[o]=t,this._node[o]=e,this._state[o]=s,this._disposed[o]=!1,i&&(this._data[o]=i),o}removeContext(t){if(void 0===this._node[t])return null;this._freeSlots.push(t);const e=this._node[t];this._node[t]=[],this._state[t]=-1,this._disposed[t]=!0;let s=this.schemaArray[this._type[t]];return this._type[t]=-1,s&&s.removeData(t),this._data[t]=void 0,e}}},26564:(t,e,s)=>{s.d(e,{C:()=>i});var r=s(45601),n=s(62209);class i{static Get(){return n.u.contextCursor.get()||new i}static Retrun(t){return n.u.contextCursor.addItem(t)}proto;_index=0;_type=0;get index(){return this._index}get data(){return this.arrays._data[this._index]}schema;get nodes(){return this.arrays._node[this._index]}get type(){return r.g.contexts.idPalette.getStringId(this.arrays._type[this._index])}arrays;constructor(){}setContext(t,e){this._index=e,this.arrays=t.graph._contexts,this._type=this.arrays._type[e]}dispose(){this.arrays.removeContext(this._index)}}},47371:(t,e,s)=>{function r(t){return[t.type,t.schema||null,t.schemaViewId||null,null]}s.d(e,{f:()=>r})},91370:(t,e,s)=>{s.d(e,{m:()=>o});var r=s(84681),n=s(47371),i=s(45601);function o(t){let e=null;if(t.components){e=[];for(let s=0;s<t.components.length;s++){const r=t.components[s];e.push((0,n.f)(r))}}let s=null;if(t.tags){s=[];for(let e=0;e<t.tags.length;e++)s.push(i.g.tags.idPalette.getNumberId(t.tags[e]))}let a=null;if(t.children){a=[];for(let e=0;e<t.children.length;e++)a.push(o(t.children[e]))}return[t.id?r.W.FromString(t.id):null,t.name,e,s,a]}},83812:(t,e,s)=>{s.d(e,{$_:()=>o,Mk:()=>a,Mn:()=>i,Si:()=>n});var r=s(45601);function n(t){return{type:r.g.components.get(t[0]).type,...t[1]?{schema:t[1]}:{},...t[2]&&"default"!==t[2]?{schemaViewId:t[2]}:{}}}function i(t){return{type:t.type,...t.schema?{schema:t.schema.toJSON()}:{},...t.schema?.__view&&"default"!==t.schema?.__view.id?{schemaViewId:t.schema.__view.id}:{}}}function o(t){return[t.type,t.schema?t.schema.toJSON():null,t.schema?t.schema.__view.id:null,null]}function a(t){return[t.type,t.schema?t.schema.__view.toRemote(t.schema):null,t.schema?t.schema.__view.id:null,!0]}},35099:(t,e,s)=>{s.d(e,{Hy:()=>h,Ud:()=>a,Uk:()=>d,li:()=>o,zl:()=>i});var r=s(84681),n=s(83812);function i(t){return{name:t[1]}}function o(t){const e=t.id;let s=null;if(t.hasComponents){s=[];for(const e of t.traverseComponents())s.push((0,n.Mn)(e))}let i=null;if(t.hasTags){i=[];for(const e of t.traverseTags())i.push(e.type)}let a=null;if(t.childrenArray?.length){a=[];for(const e of t.children())a.push(o(e))}return{...e?{id:r.W.ToHexString(e)}:{},name:t.name,...s?{components:s}:{},...i?{tags:i}:{},...a?{children:a}:{}}}function a(t){return[null,t.name,null,null,null]}function d(t){return{name:t.name}}function h(t,e=!1,s=[]){let r=null;if(e){r=[];for(const n of t.children())r.push(h(n,e,s))}let i=null;if(t.hasComponents){i=[];for(const e of t.traverseComponents())if(s.length){for(let t=0;t<s.length;t++)if(s[t].type==e.type){i.push((0,n.Mk)(e));break}}else i.push((0,n.Mk)(e))}let o=null;if(t.hasTags){o=[];for(const e of t.traverseTags())o.push(e.typeId)}return[t.id?t.id:null,t.name,i,o,r]}},33335:(t,e,s)=>{s(50464)},14740:(t,e,s)=>{s.d(e,{T:()=>u});var r=s(84681),n=s(33383),i=s(31058),o=s(61153),a=s(62209);const d=i.t.Get(),h=i.t.Get();function c(t,e,s){const n=t._nodes.addNode("string"==typeof e[0]?r.W.FromString(e[0]):e[0],s,e[1]);if(h.graph=t,h.setNode(t,n),e[2]?.length)for(let t=0;t<e[2].length;t++)h.components.add(e[2][t]);if(e[3]?.length)for(let t=0;t<e[3].length;t++)h.tags.add(e[3][t]);if(s>=0&&(d.setNode(t,s),d.addChild(h)),e[4]?.length)for(let s=0;s<e[4].length;s++)c(t,e[4][s],n);return h.setNode(t,n),e[0]=null,e[1]="",e[2]=null,e[3]=null,e[4]=null,a.u.createNodeData.addItem(e),h}class u{_systems=[];_nodes=new n._;_components=[];_contexts=new o.F;_tags=[];_updatingComponents=[];root=i.t.Get();constructor(){const t=this._nodes.addNode(null,-1,"root");this.root.setNode(this,t)}getNode(t,e=h){if(void 0===this._nodes._parents[t])throw new Error(`Node with index ${t} does not exist`);return e.setNode(this,t),e}getNodeFromId(t,e=h){"string"==typeof t&&(t=r.W.FromString(t));const s=this._nodes._idMap.get(t);if(void 0===s)throw new Error(`Node with id ${t} does not exist`);return e.setNode(this,s),e}addNode(t,e=this.root.index,s=h){const r=c(this,t,e);if(r.hasComponents){const t=r.components.components;for(let e=0;e<t.length;e+=2)this._components[t[e]].init(t[e+1])}for(const t of r.traverseChildren())if(t.hasComponents){const e=t.components.components;for(let t=0;t<e.length;t+=2)this._components[e[t]].init(e[t+1])}return r.toRef(s),s}removeNode(t){return!!this._nodes.removeNode(t)}update(){for(let t=0;t<this._updatingComponents.length;t++)this._updatingComponents[t].update();for(let t=0;t<this._systems.length;t++)this._systems[t].update()}}},50464:(t,e,s)=>{s.d(e,{$:()=>v});var r=s(14740),n=s(84681),i=s(40581),o=s(33172),a=s(568),d=s(187),h=s(34054),c=s(62209),u=s(22487),l=s(83812),_=s(47371),p=s(35099),g=s(91370),m=s(2144);const y=(t,e)=>{for(const s in t){e.children??=[];const r=t[s];if(r instanceof m.P)if(r.value instanceof m.P&&"object"==typeof r.value.value){const t={id:s,meta:r.meta,value:r.value,children:[]};e.children.push(t),y(r.value.value,t)}else e.children.push({id:s,meta:r.meta,value:r.value})}return e},v={createGraph:()=>new r.T,createNode(t,e,s,r,i=[]){const o=c.u.createNodeData.get()||[];return o[0]=t?n.W.Create():null,o[1]=e||"New Node",o[2]=r||null,o[3]=s||null,o[4]=i||null,o},schemaFromObject:t=>u.S.FromObject(t),schema(t,e){const s=new u.S(y(t,{id:"root",value:{},children:[]}).children);if(e)for(const t of e)s.createView(t);return s},property:(t,e={})=>new m.P(t,e),data:(t={})=>t,createQuery:t=>new i.T(t),registerSystem:h.b,registerComponent:a.N,registerContext:o.j,registerTag:d.K,serializeComponent:l.Mn,serializeComponentData:l.Si,createRemoteComponent:l.Mk,copyComponent:l.$_,deserializeComponentData:_.f,serializeNode:p.li,serializeNodeData:p.zl,copyNode:p.Ud,cloneNode:p.Uk,createRemoteNode:p.Hy,deserializeNodeData:g.m}},19083:(t,e,s)=>{var r;s.d(e,{J:()=>r}),function(t){t[t.Disposed=0]="Disposed",t[t.Enabled=1]="Enabled",t[t.Parented=2]="Parented",t[t.RemovedFromParent=3]="RemovedFromParent",t[t.ChildAdded=4]="ChildAdded",t[t.ChildRemoved=5]="ChildRemoved",t[t.ChildrenUpdated=6]="ChildrenUpdated",t[t.ComponentAdded=7]="ComponentAdded",t[t.ComponentRemoved=8]="ComponentRemoved",t[t.ComponentsUpdated=9]="ComponentsUpdated",t[t.TagAdded=10]="TagAdded",t[t.TagRemoved=11]="TagRemoved",t[t.TagsUpdated=12]="TagsUpdated"}(r||(r={}))},33383:(t,e,s)=>{s.d(e,{_:()=>d});var r=s(2709),n=s(62209),i=s(19083);const o=Object.values(i.J).map((t=>Number(t))).filter((t=>!Number.isNaN(t))),a=[];for(let t=0;t<o.length;t++)a[o[t]]=[];class d{_freeSlots=[];_eventPalette=new r.Z;_idMap=new Map;_indexMap=[];_names=[];_events=[];_observers=structuredClone(a);_parents=[];_children=[];_components=[];_tags=[];_context=[];_disposed=[];_enabled=[];_hasObservers=[];addNode(t,e,s){let r=this._freeSlots.length?this._freeSlots.shift():this._parents.length;return t&&this.addNodeId(r,t),this._parents[r]=e,this._names[r]=s,this._disposed[r]=!1,this._enabled[r]=!0,this._hasObservers[r]=!1,r}removeNode(t){if(void 0===this._parents[t])return!1;this._freeSlots.push(t),this._indexMap[t]&&this.removeNodeId(this._indexMap[t]),this._parents[t]=-1,this._names[t]="",this._disposed[t]=!0,this._enabled[t]=!1,this._hasObservers[t]=!1;for(let e=0;e<o.length;e++){const s=this._observers[e][t];void 0!==s&&(n.u.observers.addItem(s),this._events[e][t]=void 0)}for(let e=0;e<this._eventPalette.size;e++){const s=this._events[e][t];void 0!==s&&(n.u.observers.addItem(s),this._events[e][t]=void 0)}return void 0!==this._children[t]&&(this._children[t].length=0,n.u.numberArray.addItem(this._children[t]),this._children[t]=void 0),void 0!==this._components[t]&&(this._components[t].length=0,n.u.numberArray.addItem(this._components[t]),this._components[t]=void 0),void 0!==this._tags[t]&&(this._tags[t].length=0,n.u.numberArray.addItem(this._tags[t]),this._tags[t]=void 0),void 0!==this._context[t]&&(this._context[t].length=0,n.u.numberArray.addItem(this._context[t]),this._context[t]=void 0),!0}addNodeId(t,e){this._idMap.set(e,t),this._indexMap[t]=e}removeNodeId(t){const e=this._idMap.get(t);this._indexMap[e]=void 0,this._idMap.delete(t)}}},54324:(t,e,s)=>{s.d(e,{t:()=>d});var r=s(59252),n=s(45601),i=s(93905),o=s(62209);const a=r.w.Get();class d{static Get(){return o.u.nodeComponents.get()||new d}static Retrun(t){return o.u.nodeComponents.addItem(t)}get components(){return this.node.arrays._components[this.node.index]||null}node;constructor(){}dispose(){if(!this.components)return;const t=this.components;for(let e=0;e<t.length;e+=2)a.setInstance(this.node,t[e],t[e+1]),a.dispose()}add(t){this.components||(this.node.arrays._components[this.node.index]=o.u.numberArray.get()||[]);const e=n.g.components.get(t[0]),s=n.g.components.idPalette.getNumberId(e.type);let r=this.node.graph._components[s];r||(r=new i.N(this.node.graph,s),r.proto.update&&this.node.graph._updatingComponents.push(r),this.node.graph._components[s]=r);let d=null;d=t[3]?r.schemaArray.schema.getView(t[2]||"default").fromRemote(t[1]):e.schema&&e.schema.getView(t[2]||"default")?.createData(t[1])||null;const h=r.addComponent(this.node.index,d,t[2]||"default");return t[0]="",t[1]=null,t[2]=null,t[3]=null,o.u.createComponentData.addItem(t),this.components.push(s,h),r.observers.nodeAdded.notify(this.node.index),this.node.hasObservers&&(a.setInstance(this.node,s,h),this.node.observers.isComponentAddedSet&&this.node.observers.componentAdded.notify(a),this.node.observers.isComponentsUpdatedSet&&this.node.observers.componentsUpdated.notify(a)),h}remove(t){const e=this.components;if(!e)return;let s=-1,r=-1;const i=n.g.components.idPalette.getNumberId(t);for(let t=0;t<e.length;t+=2)if(e[t]==i){s=t,r=e[t+1];break}return-1!=s?(a.setInstance(this.node,i,r),this.components.splice(s,2),this.node.hasObservers&&(this.node.observers.isComponentRemovedSet&&this.node.observers.componentRemoved.notify(a),this.node.observers.isComponentsUpdatedSet&&this.node.observers.componentsUpdated.notify(a)),a.dispose(),!0):void 0}has(t){const e=this.components;if(!e)return!1;const s=n.g.components.idPalette.getNumberId(t);for(let t=0;t<e.length;t+=2)if(e[t]==s)return!0;return!1}get(t,e=r.w.Get()){const s=this.components;if(!s)return null;const i=n.g.components.idPalette.getNumberId(t);for(let t=0;t<s.length;t+=2)if(s[t]==i)return e.setInstance(this.node,i,s[t+1]),e;return null}getAll(t){const e=this.components;if(!e)return[];const s=[],i=n.g.components.idPalette.getNumberId(t);for(let t=0;t<e.length;t+=2)if(e[t]==i){const n=r.w.Get();n.setInstance(this.node,e[t],e[t+1]),s.push(n)}return s}removeAll(t){const e=this.components;if(!e)return!1;const s=n.g.components.idPalette.getNumberId(t);for(let t=e.length;t>0;t-=2)e[t]==s&&(a.setInstance(this.node,e[t],e[t+1]),this.components.splice(t,2),this.node.hasObservers&&(this.node.observers.isComponentRemovedSet&&this.node.observers.componentRemoved.notify(a),this.node.observers.isComponentsUpdatedSet&&this.node.observers.componentsUpdated.notify(a)));return!0}getChild(t,e=r.w.Get()){for(const s of this.node.traverseChildren()){if(!s.components)continue;const r=s.components.get(t,e);if(r)return r}return null}getParent(t,e=r.w.Get()){for(const s of this.node.traverseParents()){if(!s.components)continue;const r=s.components.get(t,e);if(r)return r}return null}}},53621:(t,e,s)=>{s.d(e,{S:()=>a});var r=s(26564),n=s(45601),i=s(31058),o=s(62209);class a{node;static Get(){return o.u.nodeContext.get()||new a}static Retrun(t){return o.u.nodeContext.addItem(t)}get context(){return this.node.arrays._context[this.node.index]}constructor(){}dispose(){if(!this.context)return;const t=this.context,e=r.C.Get();for(let s=0;s<t.length;s+=2)e.setContext(this.node,t[s]),e.dispose();r.C.Retrun(e)}add(t){const e=r.C.Get();this.context||(this.node.arrays._context[this.node.index]=o.u.numberArray.get()||[]);const s=this.context;for(let r=0;r<s.length;r++)if(e.setContext(this.node,s[r]),e.type==t[0])return e.index;const i=n.g.contexts.get(t[0]),a=n.g.contexts.idPalette.getNumberId(t[0]),d=this.node.graph._contexts.addContext(a,[this.node.index],i,i.schema?i.schema.getView(t[2]||"default").createData(t[1]):null,t[3]);return s.push(d),e.setContext(this.node,d),t[0]="",t[1]=null,t[2]=null,t[3]=null,o.u.createContextData.addItem(t),r.C.Retrun(e),d}remove(t){const e=r.C.Get(),s=this.context;for(let n=0;n<s.length;n++)if(e.setContext(this.node,s[n]),e.type==t){s.splice(n,1);for(let t=0;t<e.nodes.length;t++)if(e.nodes[t]==this.node.index){e.nodes.splice(t,1);break}return r.C.Retrun(e),!0}return r.C.Retrun(e),!1}get(t){const e=this.context,s=r.C.Get();if(e)for(let r=0;r<e.length;r++)if(s.setContext(this.node,e[r]),s.type==t)return s;const n=i.t.Get();for(const e of this.node.traverseParents(n))if(this.node.arrays._context[e.index]){const r=this.node.arrays._context[e.index];for(let n=0;n<r.length;n++)if(s.setContext(e,r[n]),s.type==t)return s.setContext(e,r[n]),s}return i.t.Retrun(n),null}}},31058:(t,e,s)=>{s.d(e,{t:()=>l});var r=s(84681),n=s(40673),i=s(63605),o=s(53621),a=s(54324),d=s(46521),h=s(59252),c=s(74182),u=s(62209);class l{static Get(){return u.u.nodeCursor.get()||new l}static Retrun(t){t.clear(t.hasEvents,t.hasContexts,t.hasObservers,t.hasComponents,t.hasTags),u.u.nodeCursor.addItem(t)}clear(t,e,s,r,o){t&&this._events&&(n.s.Retrun(this._events),this._events=null),e&&this._components&&(a.t.Retrun(this._components),this._components=null),s&&this._observers&&(i.a.Retrun(this._observers),this._observers=null),r&&this._components&&(a.t.Retrun(this._components),this._components=null),o&&this._tags&&(d.s.Retrun(this._tags),this._tags=null)}get index(){return this._index}get parentIndex(){return this.arrays._parents[this._index]}get id(){return this.graph._nodes._indexMap[this.index]||null}get name(){return this.arrays._names[this._index]}_events=null;get events(){return this._events||(this._events=n.s.Get()),this._events.node=this,this._events}get hasEvents(){return null!==this._events}_context=null;get context(){return this._context||(this._context=o.S.Get()),this._context.node=this,this._context}get hasContexts(){return null!==this._context}_observers=null;get observers(){return this._observers||(this._observers=i.a.Get()),this._observers.node=this,this._observers}get hasObservers(){return this.arrays._hasObservers[this._index]}_components=null;get components(){return this._components||(this._components=a.t.Get()),this._components.node=this,this._components}get hasComponents(){return null!==this._components}_tags=null;get tags(){return this._tags||(this._tags=d.s.Get()),this._tags.node=this,this._tags}get hasTags(){return null!==this._tags}get childrenArray(){return this.arrays._children[this._index]||null}get parent(){return this.arrays._parents[this._index]}set parent(t){this.arrays._parents[this._index]=t}graph;get arrays(){return this.graph._nodes}get enabled(){return this.arrays._enabled[this._index]}set enabled(t){this.arrays._enabled[this._index]=t,this.hasObservers&&this.observers.isEnabledSet&&this.observers.enabled.notify(t)}get isDisposed(){return this.arrays._disposed[this._index]}_index=0;constructor(){}setNode(t,e){return this._index=e,this.graph=t,void 0!==this.arrays._components[e]?(this._components=a.t.Get(),this._components.node=this):(this._components&&a.t.Retrun(this._components),this._components=null),void 0!==this.arrays._tags[e]?(this._tags=d.s.Get(),this._tags.node=this):(this._tags&&d.s.Retrun(this._tags),this._tags=null),void 0!==this.arrays._context[e]?(this._context=o.S.Get(),this._context.node=this):(this._context&&o.S.Retrun(this._context),this._context=null),this}toRef(t=new l){return t.setNode(this.graph,this.index)}*children(t=g){const e=this.childrenArray;if(!e)return!1;for(let s=0;s<e.length;s++)t.setNode(this.graph,e[s]),yield t;return!0}*traverseChildren(t=g){if(!this.childrenArray)return!1;const e=[this.childrenArray];for(;e.length;){const s=e.shift();if(s)for(let r=0;r<s.length;r++)t.setNode(this.graph,s[r]),yield t,void 0!==this.arrays._children[s[r]]&&e.push(this.arrays._children[s[r]])}return!0}*traverseParents(t=g){let e=this.parent;if(void 0===e||e<0)return!1;for(;;)if(t.setNode(this.graph,e),yield t,e=this.arrays._parents[t._index],void 0===e||e<0)return!0}*traverseComponents(t=_){const e=this.components.components;if(!e)return!1;for(let s=0;s<e.length;s+=2)yield t.setInstance(this,e[s],e[s+1]);return!0}*traverseTags(t=p){const e=this.tags.tags;if(!this.tags)return!1;for(let s=0;s<e.length;s+=2)yield t.setTag(this,e[s],e[s+1]);return!0}dispose(){if(!this.isDisposed){if(this.hasObservers&&this.observers.isDisposedSet&&this.observers.disposed.notify(this),void 0!==this.parent&&(g.setNode(this.graph,this.parent),g.removeChild(this.index)),this.arrays._components[this._index]?.length&&this.components.dispose(),this.arrays._tags[this._index]?.length&&this.tags.dispose(),this.childrenArray)for(let t=0;t<this.childrenArray.length;t++)g.setNode(this.graph,this.childrenArray[t]),g.dispose();this.graph.removeNode(this.index),this.clear(this.hasEvents,this.hasContexts,this.hasObservers,this.hasComponents,this.hasTags)}}hasChild(t){if(!this.childrenArray)return!1;for(let e=0;e<this.childrenArray.length;e++)if(this.childrenArray[e]==t.index)return!0;return!1}parentTo(t){t.hasChild(this)||(void 0!==this.parent&&(g.setNode(this.graph,this.parent),g.removeChild(this.index)),t.addChild(this),this.parent=t.index,this.hasObservers&&this.observers.isParentedSet&&t.observers.parented.notify(g))}getChild(t,e=l.Get()){const s=this.childrenArray;return s&&void 0!==s[t]?e.setNode(this.graph,s[t]):null}addChild(t){this.hasChild(t)||(this.childrenArray||(this.arrays._children[this._index]=u.u.numberArray.get()||[]),t.parent=this.index,this.childrenArray.push(t.index),this.hasObservers&&(this.observers.isChildAddedSet&&this.observers.childAdded.notify(t),this.observers.isChildrenUpdatedSet&&this.observers.childrenUpdated.notify(t)),t.hasObservers&&t.observers.isParentedSet&&t.observers.parented.notify(t))}removeChild(t){if(this.childrenArray){for(let e=0;e<this.childrenArray.length;e++)if(this.childrenArray[e]==t){const t=this.childrenArray.splice(e,1)[0];return g.setNode(this.graph,t),this.hasObservers&&(this.hasObservers&&this.observers.isChildRemovedSet&&this.observers.childRemoved.notify(g),this.hasObservers&&this.observers.isChildrenUpdatedSet&&this.observers.childrenUpdated.notify(g)),g.hasObservers&&g.observers.isRemovedFromParentSet&&g.observers.removedFromParent.notify(g),t}return null}}addUniqueId(){let t=this.graph._nodes._indexMap[this.index];return t||(t=r.W.Create()),this.graph._nodes.addNodeId(this.index,t),t}returnCursor(){return l.Retrun(this)}cloneCursor(t){const e=t||l.Get();return e.setNode(this.graph,this._index),e}}const _=h.w.Get(),p=c.v.Get(),g=l.Get()},40673:(t,e,s)=>{s.d(e,{s:()=>o});var r=s(62209),n=s(82180);class i{id;node;data}class o{static Get(){return r.u.nodeEvents.get()||new o}static Retrun(t){return r.u.nodeEvents.addItem(t)}get events(){return this.node.arrays._events}get index(){return this.node.index}node;cursor=new i;constructor(){}hasListener(t){const e=this.node.arrays._eventPalette.getNumberId(t);return void 0!==e&&void 0!==this.node.arrays._events[e][this.index]}clearListeners(t){const e=this.node.arrays._eventPalette.getNumberId(t);if(void 0===e)return!1;let s=this.node.arrays._events[e]?.[this.index];if(!s)return!1;s.clear(),r.u.observers.addItem(s),this.node.arrays._events[e][this.index]=void 0}addListener(t,e){const s=this.node.arrays._eventPalette.isRegistered(t)?this.node.arrays._eventPalette.getNumberId(t):this.node.arrays._eventPalette.register(t);let i=this.node.arrays._events[s];i||(i=[],this.node.arrays._events[s]=i);let o=i[this.index];o||(o=r.u.observers.get()||new n.c,i[this.index]=o),o.subscribe(e)}removeListener(t,e){const s=this.node.arrays._eventPalette.getNumberId(t);if(void 0===s)return!1;let r=this.node.arrays._events[s];return!(!r||!r[this.index]||(r[this.index].unsubscribe(e),0))}dispatch(t,e){const s=this.node.arrays._eventPalette.getNumberId(t);if(void 0===s)return!1;let r=this.node.arrays._events[s];return!(!r||!r[this.index]||(r[this.index].notify(e),this.cursor.id=t,this.cursor.data=e,0))}dispatchDeep(t,e){for(const s of this.node.traverseChildren())s.events.dispatch(t,e)}}},84681:(t,e,s)=>{s.d(e,{W:()=>o});const r=new ArrayBuffer(16),n=new Uint8Array(r),i=new DataView(r);class o{static Create(){return crypto.getRandomValues(n),BigInt(i.getUint32(0))<<96n|BigInt(i.getUint32(4))<<64n|BigInt(i.getUint32(8))<<32n|BigInt(i.getUint32(12))}static CreateString(){return this.ToHexString(this.Create())}static FromString(t){return BigInt("0x"+t)}static ToHexString(t){return t.toString(16).padStart(32,"0")}}},63605:(t,e,s)=>{s.d(e,{a:()=>o});var r=s(82180),n=s(19083),i=s(62209);class o{node;static Get(){return i.u.nodeObservers.get()||new o}static Retrun(t){return i.u.nodeObservers.addItem(t)}constructor(){}get observers(){return this.node.arrays._observers}get disposed(){let t=this.observers[n.J.Disposed][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.Disposed][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get enabled(){let t=this.observers[n.J.Enabled][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.Enabled][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get parented(){let t=this.observers[n.J.Parented][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.Parented][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get removedFromParent(){let t=this.observers[n.J.RemovedFromParent][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.RemovedFromParent][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get childAdded(){let t=this.observers[n.J.ChildAdded][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.ChildAdded][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get childRemoved(){let t=this.observers[n.J.ChildRemoved][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.ChildRemoved][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get childrenUpdated(){let t=this.observers[n.J.ChildrenUpdated][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.ChildrenUpdated][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get isDisposedSet(){return void 0!==this.observers[n.J.Disposed][this.node.index]}get isEnabledSet(){return void 0!==this.observers[n.J.Enabled][this.node.index]}get isParentedSet(){return void 0!==this.observers[n.J.Parented][this.node.index]}get isRemovedFromParentSet(){return void 0!==this.observers[n.J.RemovedFromParent][this.node.index]}get isChildAddedSet(){return void 0!==this.observers[n.J.ChildAdded][this.node.index]}get isChildRemovedSet(){return void 0!==this.observers[n.J.ChildRemoved][this.node.index]}get isChildrenUpdatedSet(){return void 0!==this.observers[n.J.ChildrenUpdated][this.node.index]}get componentAdded(){let t=this.observers[n.J.ComponentAdded][this.node.index];return t||(t=new r.c,this.observers[n.J.ComponentAdded][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get componentRemoved(){let t=this.observers[n.J.ComponentRemoved][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.ComponentRemoved][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get componentsUpdated(){let t=this.observers[n.J.ComponentsUpdated][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.ComponentsUpdated][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get isComponentAddedSet(){return void 0!==this.observers[n.J.ComponentAdded][this.node.index]}get isComponentRemovedSet(){return void 0!==this.observers[n.J.ComponentRemoved][this.node.index]}get isComponentsUpdatedSet(){return void 0!==this.observers[n.J.ComponentsUpdated][this.node.index]}get tagsAdded(){let t=this.observers[n.J.TagAdded][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.TagAdded][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get tagsRemoved(){let t=this.observers[n.J.TagRemoved][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.TagRemoved][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get tagsUpdated(){let t=this.observers[n.J.TagsUpdated][this.node.index];return t||(t=i.u.observers.get()||new r.c,this.observers[n.J.TagsUpdated][this.node.index]=t),this.node.arrays._hasObservers[this.node.index]=!0,t}get isTagsAddedSet(){return void 0!==this.observers[n.J.TagAdded][this.node.index]}get isTagsRemovedSet(){return void 0!==this.observers[n.J.TagRemoved][this.node.index]}get isTagsUpdatedSet(){return void 0!==this.observers[n.J.TagsUpdated][this.node.index]}}},46521:(t,e,s)=>{s.d(e,{s:()=>a});var r=s(62209),n=s(45601),i=s(74182);const o=i.v.Get();class a{node;static Get(){return r.u.nodeTags.get()||new a}static Retrun(t){return r.u.nodeTags.addItem(t)}get tags(){return this.node.arrays._tags[this.node.index]}constructor(){}dispose(){for(let t=0;t<this.tags.length;t+=2)o.setTag(this.node,this.tags[t],this.tags[t+1]),o.dispose()}add(t,e=o){const s=this.node.graph._tags[t].addTag(this.node.index);return this.tags.push(t,s),e.setTag(this.node,t,s),this.node.hasObservers&&this.node.observers.isTagsAddedSet&&this.node.observers.tagsAdded.notify(e),e}remove(t){const e=n.g.tags.idPalette.getNumberId(t),s=this.tags;for(let t=0;t<s.length;t++)if(s[t]==e)return o.setTag(this.node,e,s[t]),o.dispose(),this.tags.splice(t,2),this.node.hasObservers&&this.node.observers.isTagsRemovedSet&&this.node.observers.tagsRemoved.notify(o),this.node.hasObservers&&this.node.observers.isTagsUpdatedSet&&this.node.observers.tagsUpdated.notify(0),!0;return!1}get(t,e=o){const s=n.g.tags.idPalette.getNumberId(t),r=this.tags;for(let t=0;t<r.length;t+=2)if(r[t]==s)return e.setTag(this.node,r[t],r[t+1]),e;return null}getChild(t,e=o){for(const s of this.node.traverseChildren()){const r=s.tags.get(t,e);if(r)return r}return null}getAllChildlren(t){const e=[];for(const s of this.node.traverseChildren()){const r=s.tags.get(t);r&&e.push(i.v.Get().setTag(this.node,r.typeId,r.index))}return e}getParent(t,e=o){for(const s of this.node.traverseParents()){const r=s.tags.get(t,e);if(r)return r}return null}getAllParents(t){const e=[];for(const s of this.node.traverseParents()){const r=s.tags.get(t,o);r&&e.push(i.v.Get().setTag(this.node,r.typeId,r.index))}return e}}},62209:(t,e,s)=>{s.d(e,{u:()=>n});var r=s(41168);class n{static observers=new r.K;static numberArray=new r.K;static createNodeData=new r.K;static createComponentData=new r.K;static createContextData=new r.K;static nodeCursor=new r.K;static nodeContext=new r.K;static nodeObservers=new r.K;static nodeEvents=new r.K;static nodeComponents=new r.K;static nodeTags=new r.K;static tagCursor=new r.K;static componentCursor=new r.K;static contextCursor=new r.K}},18852:(t,e,s)=>{s.d(e,{k:()=>a});var r=s(31058),n=s(45601),i=s(93905),o=s(51475);class a{graph;data;nodes=[];_updateFunction;nodeCursor=r.t.Get();constructor(t,e){this.graph=t,this.data=e}evulate(t){if(this.data.inclueComponents)for(const e of this.data.inclueComponents)if(!t.components.has(e.type))return!1;if(this.data.includeTags)for(const e of this.data.includeTags)if(!t.hasTags||!t.tags.get(e.id))return!1;if(this.data.excludeComponents)for(const e of this.data.excludeComponents)if(t.components.has(e.type))return!1;if(this.data.excludeTags)for(const e of this.data.excludeTags)if(t.hasTags&&t.tags.get(e.id))return!1;return!0}init(){if(this._updateFunction=t=>{const e=this.nodeCursor.setNode(this.graph,t);if(this.evulate(e))this.nodes.push(t);else for(let t=0;t<this.nodes.length;t++)this.nodes[t]==e.index&&this.nodes.splice(t,1)},this.data.inclueComponents)for(const t of this.data.inclueComponents){const e=n.g.components.idPalette.getNumberId(t.type);let s=this.graph._components[e];s||(s=new i.N(this.graph,e),this.graph._components[e]=s),s.observers.nodeAdded.subscribe(this._updateFunction),s.observers.nodeRemoved.subscribe(this._updateFunction)}if(this.data.includeTags)for(const t of this.data.includeTags){const e=n.g.tags.get(t.id),s=n.g.tags.idPalette.getNumberId(t.id);let r=this.graph._tags[s];r||(r=new o.k(t.id),this.graph._tags[s]=r),r.observers.nodeAdded.subscribe(this._updateFunction),r.observers.nodeRemoved.subscribe(this._updateFunction);for(const t of e.traverseChildren()){const e=n.g.tags.idPalette.getNumberId(t.id);let s=this.graph._tags[e];s||(s=new o.k(t.id),this.graph._tags[e]=s),s.observers.nodeAdded.subscribe(this._updateFunction),s.observers.nodeRemoved.subscribe(this._updateFunction)}}}dispose(){if(this.data.inclueComponents)for(const t of this.data.inclueComponents){const e=this.graph._components[n.g.components.idPalette.getNumberId(t.type)];e&&(e.observers.nodeAdded.unsubscribe(this._updateFunction),e.observers.nodeRemoved.unsubscribe(this._updateFunction))}if(this.data.includeTags)for(const t of this.data.includeTags){const e=n.g.tags.get(t.id),s=this.graph._tags[n.g.tags.idPalette.getNumberId(t.id)];if(s){s.observers.nodeAdded.unsubscribe(this._updateFunction),s.observers.nodeRemoved.unsubscribe(this._updateFunction);for(const t of e.traverseChildren()){const e=this.graph._tags[n.g.tags.idPalette.getNumberId(t.id)];e&&(e.observers.nodeAdded.unsubscribe(this._updateFunction),e.observers.nodeRemoved.unsubscribe(this._updateFunction))}}}}}},40581:(t,e,s)=>{s.d(e,{T:()=>n});var r=s(18852);class n{data;queries=new Map;constructor(t){this.data=t}add(t){if(this.queries.has(t))return this.queries.get(t);const e=new r.k(t,this.data);return this.queries.set(t,e),e.init(),e}remove(t){const e=this.queries.get(t);return!!e&&(e.dispose(),!0)}}},45601:(t,e,s)=>{s.d(e,{g:()=>i});var r=s(2709);class n{itemtype;items=[];idPalette=new r.Z;constructor(t){this.itemtype=t}get(t){const e="string"==typeof t?this.items[this.idPalette.getNumberId(t)]:this.items[t];if(!e)throw new Error(`[${this.itemtype}]: Entry with id ${t} does not exist`);return e}has(t){return this.idPalette.isRegistered(t)}register(t,e){const s=this.idPalette.register(t);return this.items[s]=e,s}}class i{static components=new n("Components");static contexts=new n("Context");static tags=new n("Tags");static systems=new n("Systems")}},568:(t,e,s)=>{s.d(e,{N:()=>a});var r=s(45601),n=s(59252),i=s(31058),o=s(62209);const a=t=>{const e=r.g.components.register(t.type,t);t.shared=t.shared||{};const s=(e,s)=>{const r=o.u.createComponentData.get()||[];return r[0]=t.type,r[1]=e||{},r[2]=s||"default",r};return Object.assign(s,t,{data:t,type:t.type,typeId:e,*getNodes(t,s=i.t.Get()){const r=t._components[e];if(!r)return!1;for(let e=0;e<r._disposed.length;e++)s.setNode(t,r._node[e]),yield s;return i.t.Retrun(s),!0},*getComponents(t,s=n.w.Get(),r=i.t.Get()){const o=t._components[e];if(!o)return!1;for(let n=0;n<o._disposed.length;n++)r.setNode(t,o._node[n]),s.setInstance(r,e,n),yield s;return n.w.Retrun(s),i.t.Retrun(r),!0},set(t,r,i,o=n.w.Get()){const a=t.components.add(s(r,i));return o.setInstance(t,e,a),t.graph._components[e].init(a),o},has:e=>e.components.has(t.type),get:(e,s)=>e.components.get(t.type,s),getRequired(e,s){const r=e.components.get(t.type,s);if(!r)throw new Error(`Node [${e.name}] does not have required component [${t.type}].`);return r},getChild:(e,s)=>e.components.getChild(t.type,s),getRequiredChild(e,s){const r=e.components.getChild(t.type,s);if(!r)throw new Error(`Node [${e.name}] does not have a child with required component [${t.type}].`);return r},getParent:(e,s)=>e.components.getParent(t.type,s),getRequiredParent(e,s=n.w.Get()){const r=e.components.getParent(t.type,s);if(!r)throw new Error(`Node [${e.name}] does not have a parent with required component [${t.type}].`);return r},getAll:e=>e.components.getAll(t.type),removeAll:e=>e.components.removeAll(t.type),remove:e=>e.components.remove(t.type),nodeData:{get:e=>e.components?.find((e=>e.type==t.type))||null,getAll:e=>e.components?.filter((e=>e.type==t.type)),remove:e=>e.components?.splice(e.components?.findIndex((e=>e.type==t.type)))[0]||null,removeAll(e){const s=this.getAll(e);return e.components=e.components?.filter((e=>e.type!=t.type)),s?.length?s:null},set:(e,s)=>{e.components??=[],e.components.push({type:t.type,schema:{}})}}})}},33172:(t,e,s)=>{s.d(e,{j:()=>i});var r=s(45601),n=s(62209);function i(t){r.g.contexts.register(t.type,t);const e=(e,s,r)=>{const i=n.u.createContextData.get()||[];return i[0]=t.type,i[1]=e||{},i[2]=s||"default",i[3]=r||null,i};return Object.assign(e,t,{data:t,set:(t,s,r,n)=>t.context.add(e(s,r,n)),get:e=>e.context.get(t.type),getRequired:e=>{const s=e.context.get(t.type);if(!s)throw new Error(`Could not find required context type: ${t.type}`);return s},remove:e=>e.context.remove(t.type)})}},34054:(t,e,s)=>{s.d(e,{b:()=>i});var r=s(45601),n=s(92148);function i(t){const e=new n.C(t);return r.g.systems.register(t.type,e),Object.assign(t,{prototype:e,set:t=>e.add(t),get:t=>e.systems.get(t)||null,remove:t=>e.remove(t)})}},187:(t,e,s)=>{s.d(e,{K:()=>o});var r=s(45601),n=s(74182),i=s(8228);function o(t){const e=new i.v(null,t),s=r.g.tags.register(t.id,e),o=()=>s;return Object.assign(o,t,{tag:e,data:t,getChild:(e,s)=>e.tags.getChild(t.id,s),getAllChildlren:e=>e.tags.getAllChildlren(t.id),getParent:(e,s)=>e.tags.getParent(t.id,s),getAllParents:e=>e.tags.getAllParents(t.id),set(t,e=n.v.Get()){const r=t.tags.add(o());return e.setTag(t,s,r),e},get:(e,s)=>e.tags.get(t.id,s),remove:e=>e.tags.remove(t.id)})}},78598:(t,e,s)=>{s.d(e,{p:()=>n});var r=s(5396);function n(){class t{__view;__cursor;__cursors=[];constructor(t){this.__view=t,this.__cursor=new r.Z(this.__view.schema.array)}__array;__index;setInstance(t){this.__cursor.setIndex(t)}getInstance(){return this.__cursor._index}getCursor(){return this.__cursor}getSchemaIndex(){return this.__view.schema.index}clone(){return new t(this.__view)}toJSON(){return this.__view.toJSON(this)}}return t}},18517:(t,e,s)=>{s.d(e,{Wl:()=>h,r5:()=>o});var r=s(78598);const n={i8(t,e,s){t.setInt8(e,s)},ui8(t,e,s){t.setUint8(e,s)},i16(t,e,s){t.setInt16(e,s)},ui16(t,e,s){t.setUint16(e,s)},i32(t,e,s){t.setInt32(e,s)},ui32(t,e,s){t.setUint32(e,s)},f32(t,e,s){t.setFloat32(e,s)},f64(t,e,s){t.setFloat64(e,s)}},i={i8:(t,e)=>t.getInt8(e),ui8:(t,e)=>t.getUint8(e),i16:(t,e)=>t.getInt16(e),ui16:(t,e)=>t.getUint16(e),i32:(t,e)=>t.getInt32(e),ui32:(t,e)=>t.getUint32(e),f32:(t,e)=>t.getFloat32(e),f64:(t,e)=>t.getFloat64(e)};function o(t,e,s,r){if(e.binary)return"object"==typeof e.binary?e.binary.set(t.view,e,s,r):n[e.binary](t.view,s,r)}function a(t,e,s){if(e.binary)return"object"==typeof e.binary?e.binary.get(t.view,e,s):i[e.binary](t.view,s)}function d(t,e){for(let s=0;s<e.length;s++){const r=e[s],n=r.index;if(r.children){class e{__cursor;__cursors;__view;constructor(t,e,s){this.__cursor=t,this.__cursors=e,this.__view=s}}d(e,r.children),Object.defineProperty(t.prototype,r.id,{get(){let t=this.__cursors[n];return t||(t=new e(this.__cursor,this.__cursors,this.__view),this.__cursors[n]=t),t},set(t){}})}else Object.defineProperty(t.prototype,r.id,{get(){return this.__cursor.hasProxy(n)?this.__cursor.fetchProxyData(n):a(this.__cursor.data,this.__view.meta[n],this.__view.byteOffset[n])},set(t){let e=this.__cursor.getObserver(n),s=this.__cursor.hasProxy(n);if(e&&(s?this.__cursor.fetchProxyData(n):a(this.__cursor.data,this.__view.meta[n],this.__view.byteOffset[n]))!=t)return o(this.__cursor.data,this.__view.meta[n],this.__view.byteOffset[n],t),s&&this.__cursor.setProxyData(n,t),void e.notify(t);o(this.__cursor.data,this.__view.meta[n],this.__view.byteOffset[n],t),s&&this.__cursor.setProxyData(n,t)}})}}function h(t){const e=(0,r.p)();return d(e,t.root.children),e}},67065:(t,e,s)=>{function r(t,e){for(let s=0;s<e.length;s++){const n=e[s],i=n.index;if(!n.children){t[n.id]=i;continue}const o={};r(o,n.children),t[n.id]=o}}function n(t){const e={};return r(e,t.root.children),e}s.d(e,{s:()=>n})},40438:(t,e,s)=>{s.d(e,{r:()=>i});var r=s(78598);function n(t,e){for(let s=0;s<e.length;s++){const r=e[s],i=r.index;if(r.children){class e{__cursor;__cursors;constructor(t,e){this.__cursor=t,this.__cursors=e}}n(e,r.children),Object.defineProperty(t.prototype,r.id,{get(){let t=this.__cursors[i];return t||(t=new e(this.__cursor,this.__cursors),this.__cursors[i]=t),t},set(t){}})}else Object.defineProperty(t.prototype,r.id,{get(){return this.__cursor.hasProxy(i)?this.__cursor.fetchProxyData(i):this.__cursor.data[i]},set(t){let e=this.__cursor.getObserver(i),s=this.__cursor.hasProxy(i);if(e&&(s?this.__cursor.fetchProxyData(i):this.__cursor.data[i])!=t)return this.__cursor.data[i]=t,s&&this.__cursor.setProxyData(i,t),void e.notify(t);this.__cursor.data[i]=t,s&&this.__cursor.setProxyData(i,t)}})}}function i(t){const e=(0,r.p)();return n(e,t.root.children),e}},34336:(t,e,s)=>{s.d(e,{f:()=>i});var r=s(78598);function n(t,e){for(let s=0;s<e.length;s++){const r=e[s],i=r.index;if(r.children){class e{__cursor;__cursors;constructor(t,e){this.__cursor=t,this.__cursors=e}}n(e,r.children),Object.defineProperty(t.prototype,r.id,{get(){let t=this.__cursors[i];return t||(t=new e(this.__cursor,this.__cursors),this.__cursors[i]=t),t},set(t){}})}else Object.defineProperty(t.prototype,r.id,{get(){return this.__cursor.hasProxy(i)?this.__cursor.fetchProxyData(i):this.__cursor.data[i]},set(t){let e=this.__cursor.getObserver(i),s=this.__cursor.hasProxy(i);if(e&&(s?this.__cursor.fetchProxyData(i):this.__cursor.data[i])!=t)return this.__cursor.data[i]=t,s&&this.__cursor.setProxyData(i,t),void e.notify(t);this.__cursor.data[i]=t,s&&this.__cursor.setProxyData(i,t)}})}}function i(t){const e=(0,r.p)();return n(e,t.root.children),e}},14869:(t,e,s)=>{s.d(e,{m:()=>r});class r{index;id="";name;type="";meta;value=null;children;constructor(t,e){this.index=e,this.id=t.id,this.name=t.name,this.value=t.value,this.meta=t.meta}}},3318:(t,e,s)=>{s.d(e,{R:()=>r,i:()=>n});const r={i8:Int8Array,ui8:Uint8Array,i16:Int16Array,ui16:Uint16Array,i32:Int32Array,ui32:Uint32Array,f32:Float32Array,f64:Float64Array},n={i8:Int8Array.BYTES_PER_ELEMENT,ui8:Uint8Array.BYTES_PER_ELEMENT,i16:Int16Array.BYTES_PER_ELEMENT,ui16:Uint16Array.BYTES_PER_ELEMENT,i32:Int32Array.BYTES_PER_ELEMENT,ui32:Uint32Array.BYTES_PER_ELEMENT,f32:Float32Array.BYTES_PER_ELEMENT,f64:Float64Array.BYTES_PER_ELEMENT}},22487:(t,e,s)=>{s.d(e,{S:()=>m});var r=s(40438),n=s(67065),i=s(14869),o=s(3318),a=s(34336),d=s(18517),h=s(3498),c=s(57758),u=s(2709);const l=(t,e,s)=>{t.children??=[];for(let r=0;r<e.length;r++){const n=e[r];if("object"==typeof n.value&&!n.children){n.children??=[];for(const t in n.value){const e=n.value[t],s=structuredClone(n.meta||{});s.child=!0,n.children.push({id:t,meta:s,value:e})}}if(n.children){const e=new i.m(n,s+1);t.children.push(e),s=l(e,n.children,s)}else s++,t.children.push(new i.m(n,s))}return s},_=(t,e,s)=>{for(let r=0;r<t.children.length;r++){const n=t.children[r];n.children?_(n,e,s):(e[Number(n.index)]=structuredClone(n.value),n.meta&&(s[n.index]=structuredClone(n.meta)))}return e};function p(t,e){for(const s in t){const r=t[s];"object"==typeof r?e.children.push(p(r,{id:s,value:{},children:[]})):e.children.push({id:s,value:r})}return e}function g(t,e,s){for(const r of t.children)void 0!==s[r.id]&&(r.children?g(r,e,s[r.id]):e[r.index]=s[r.id]);return e}class m{static FromObject(t){const e=[];for(const s in t){const r=t[s];"object"==typeof r?e.push(p(r,{id:s,value:{},children:[]})):e.push({id:s,value:r})}return new m(e)}root=new i.m({id:"__root__",meta:{},value:{}},-1);_objectCursorClass;_typedArrayCursorClass;_binaryObjectCursorClass;index;shape;_data=[];_meta=[];viewIdPalettew=new u.Z;views=[];array;constructor(t){l(this.root,t,-1),this.index=(0,n.s)(this),_(this.root,this._data,this._meta),this.createObjectView("default"),this.array=new c.F(this)}createData(t=[],e){for(let e=0;e<this._data.length;e++)t[e]="object"==typeof this._data[e]?structuredClone(this._data[e]):this._data[e];return g(this.root,t,e),t}getView(t){return this.viewIdPalettew.isRegistered(t)?this.views[this.viewIdPalettew.getNumberId(t)]:null}createView(t){let e=null,s=this._meta;if(t.meta&&(s=function(t,e,s){let r=[...e];for(let e=0;e<t.length;e++)s[e]&&(r[e]=s[e]);return r}(this._data,s,t.meta)),"object"==t.type&&(this._objectCursorClass||(this._objectCursorClass=(0,r.r)(this)),e=new h.T(this,t.id,s,[],0,t,this._objectCursorClass)),"typed-array"==t.type&&(this._typedArrayCursorClass||(this._typedArrayCursorClass=(0,a.f)(this)),e=new h.T(this,t.id,s,[],0,t,this._typedArrayCursorClass)),"binary-object"==t.type){this._binaryObjectCursorClass||(this._binaryObjectCursorClass=(0,d.Wl)(this));const{byteSize:r,byteOffsets:n}=(t=>{let e=0;const s=[];for(let r=0;r<t.length;r++){const n=t[r];n&&n.binary&&(s[r]=e,"object"!=typeof n.binary?"string"!=typeof n.binary||(e+=o.i[n.binary]):e+=n.binary.byteSize)}return{byteSize:e,byteOffsets:s}})(s);e=new h.T(this,t.id,s,n,r,t,this._binaryObjectCursorClass)}if(!e)throw new Error("Invalid data");const n=this.viewIdPalettew.register(t.id);return this.views[n]=e,e}createObjectView(t,e=null){return this.createView({id:t,type:"object",meta:e})}createBinaryObjectView(t,e=!1,s=null){return this.createView({id:t,type:"binary-object",meta:s,sharedMemory:e||void 0})}createTypedArrayView(t,e,s=!1,r=null){return this.createView({id:t,type:"typed-array",meta:r,arrayType:e,sharedMemory:s||void 0})}}},2144:(t,e,s)=>{s.d(e,{P:()=>r});class r{value;meta;constructor(t,e){this.value=t,this.meta=e}}},57758:(t,e,s)=>{s.d(e,{F:()=>n});var r=s(62209);class n{schema;_data=[];_dataViews=[];_observers=[];_proxyObjects=[];_proxyKeys=[];constructor(t){this.schema=t;for(let e=0;e<t._data.length;e++)this._observers[e]=[],this._proxyObjects[e]=[],this._proxyKeys[e]=[]}createViewCursor(t){if(void 0===this._data[t])return null;const e=this._dataViews[t],s=this.schema.views[e];return s?s.createCursor():null}setData(t,e,s){this._data[t]=e,this._dataViews[t]=this.schema.viewIdPalettew.getNumberId(s||"default")}getViewAt(t){return void 0===this._data[t]?null:this.schema.getView(this.schema.viewIdPalettew.getStringId(this._dataViews[t]))}removeData(t){if(void 0===this._data[t])return!1;this.getViewAt(t).returnData(this._data[t]),this._data[t]=void 0,this._dataViews[t]=-1;for(let e=0;e<this.schema._data.length;e++)this._observers[e][t]&&(this._observers[e][t].clear(),r.u.observers.addItem(this._observers[e][t]),this._observers[e][t]=void 0),this._proxyObjects[e][t]=void 0,this._proxyKeys[e][t]=void 0;return!0}getObserver(t,e){if(!this._observers[t][e])return null;return this._observers[t][e]||null}setObserver(t,e,s){this._observers[t][e]=s||void 0}hasProxy(t,e){return void 0!==this._proxyObjects[t][e]}fetchProxyData(t,e){return this._proxyObjects[t][e][this._proxyKeys[t][e]]}setProxyData(t,e,s){this._proxyObjects[t][e][this._proxyKeys[t][e]]=s}removeProxy(t,e){this._proxyObjects[t][e]=void 0,this._proxyKeys[t][e]=void 0}setProxy(t,e,s,r){this._proxyObjects[t][e]=s,this._proxyKeys[t][e]=r}}},5396:(t,e,s)=>{s.d(e,{Z:()=>i});var r=s(62209),n=s(82180);class i{schemaArray;constructor(t){this.schemaArray=t}get data(){return this.schemaArray._data[this._index]}set data(t){this.schemaArray._data[this._index]=t}_index=0;setIndex(t){this._index=t}getObserver(t){return this.schemaArray.getObserver(t,this._index)}getOrCreateObserver(t){let e=this.schemaArray.getObserver(t,this._index);return e||(e=r.u.observers.get()||new n.c,this.schemaArray.setObserver(t,this._index,e)),e}removeObserver(t){let e=this.schemaArray.getObserver(t,this._index);return!!e&&(e.clear(),r.u.observers.addItem(e),this.schemaArray.setObserver(t,this._index,null),!0)}setObserver(t,e){return this.schemaArray.setObserver(t,this._index,e)}hasProxy(t){return this.schemaArray.hasProxy(t,this._index)}fetchProxyData(t){return this.schemaArray.fetchProxyData(t,this._index)}setProxyData(t,e){return this.schemaArray.setProxyData(t,this._index,e)}removeProxy(t){return this.schemaArray.removeProxy(t,this._index)}setProxy(t,e,s){return this.schemaArray.setProxy(t,this._index,e,s)}}},3498:(t,e,s)=>{s.d(e,{T:()=>d});var r=s(41168),n=s(18517),i=s(3318);function o(t,e,s){for(const r of t.children)r.children?(e[r.id]??={},o(r,e[r.id],s[r.id])):e[r.id]=s[r.id];return e}const a=[];class d{schema;id;meta;byteOffset;byteSize;_createData;_cursorClass;_dataPool=new r.K;constructor(t,e,s,r,n,i,o){this.schema=t,this.id=e,this.meta=s,this.byteOffset=r,this.byteSize=n,this._createData=i,this._cursorClass=o}returnData(t){this._dataPool.addItem(t)}createData(t){const e=this._createData;t&&(a.length=0);let s=t?this.schema.createData(a,t):this.schema._data;if(this._dataPool.items.length){const t=this._dataPool.get();if("object"==e.type){for(let e=0;e<s.length;e++)t[e]="object"==typeof s[e]?structuredClone(s[e]):s[e];return t}if("typed-array"==e.type)return t.set(s),t;if("binary-object"==e.type){for(let e=0;e<s.length;e++){const r=this.meta[e];r.binary&&(0,n.r5)(t,r,this.byteOffset[e],s[e])}return t}}if("object"==e.type){const t=new Array(s.length);for(let e=0;e<s.length;e++)t[e]="object"==typeof s[e]?structuredClone(s[e]):s[e];return t}if("typed-array"==e.type){const t=s.length,r=i.R[e.arrayType];let n=t*r.BYTES_PER_ELEMENT;const o=new r(e.sharedMemory?new SharedArrayBuffer(n):new ArrayBuffer(n));return o.set(s),o}if("binary-object"==e.type){let t=this.byteSize;const r=e.sharedMemory?new SharedArrayBuffer(t):new ArrayBuffer(t),i={view:new DataView(r),buffer:new Uint8Array(r)};for(let t=0;t<s.length;t++){const e=this.meta[t];e.binary&&(0,n.r5)(i,e,this.byteOffset[t],s[t])}return i}throw new Error("Invalid create data")}createCursor(){return new this._cursorClass(this,this.meta,this._createData,this.byteOffset)}toRemote(t){return"object"==this._createData.type||"typed-array"==this._createData.type?t.__cursor.data:"binary-object"==this._createData.type?t.__cursor.data.buffer:void 0}fromRemote(t){return"object"==this._createData.type||"typed-array"==this._createData.type?t:"binary-object"==this._createData.type?{view:new DataView(t.buffer),buffer:new Uint8Array(t.buffer)}:void 0}toJSON(t){return o(this.schema.root,{},t)}}},82895:(t,e,s)=>{s.d(e,{b:()=>n});var r=s(31058);class n{graph;proto;queries=[];node=r.t.Get();constructor(t,e){this.graph=t,this.proto=e;for(const s of e.queries)this.queries.push(s.add(t));this.graph._systems.push(this)}update(){this.proto.update(this)}dispose(){for(let t=0;t<this.graph._systems.length;t++)this.graph._systems[t]==this&&this.graph._systems.splice(t,1)}}},92148:(t,e,s)=>{s.d(e,{C:()=>n});var r=s(82895);class n{data;systems=new Map;constructor(t){this.data=t}add(t){if(this.systems.has(t))return this.systems.get(t);const e=new r.b(t,this.data);return this.systems.set(t,e),e}remove(t){const e=this.systems.get(t);return!!e&&(e.dispose(),!0)}}},8228:(t,e,s)=>{s.d(e,{v:()=>r});class r{parent;tagData;get id(){return this.tagData.id}children=[];constructor(t,e){this.parent=t,this.tagData=e}*traverseChildren(){const t=[...this.children];for(;t.length;){const e=t.shift();yield e,e.children.length&&t.push(...e.children)}}*traverseParents(){let t=this.parent;for(;t;)yield t,t=t.parent}addChild(t){t.parent=this,this.children.push(t)}removeChild(t){const e=this.children.splice(this.children.findIndex((e=>e.id==t)),1)[0];return e?(e.parent=null,e):null}dispose(){for(const t of this.children)t.dispose();this.children=[]}toJSON(){return{id:this.id,meta:this.tagData.meta}}}},51475:(t,e,s)=>{s.d(e,{k:()=>o});var r=s(82180),n=s(45601);class i{tagAdded=new r.c;componentRemoved=new r.c;nodeAdded=new r.c;nodeRemoved=new r.c}class o{typeId;_freeSlots=[];_node=[];observers=new i;typeNumberId;constructor(t){this.typeId=t,this.typeNumberId=n.g.tags.idPalette.getNumberId(t)}addTag(t){let e=this._freeSlots.length?this._freeSlots.shift():this._node.length;return this._node[e]=t,this.observers.tagAdded.notify(e),this.observers.nodeAdded.notify(t),e}removeTag(t){return void 0===this._node[t]?null:(this.observers.tagAdded.notify(t),this.observers.nodeRemoved.notify(this._node[t]),this._freeSlots.push(t),this._node[t]=-1,!0)}}},74182:(t,e,s)=>{s.d(e,{v:()=>i});var r=s(45601),n=s(62209);class i{static Get(){return n.u.tagCursor.get()||new i}static Retrun(t){return n.u.tagCursor.addItem(t)}get id(){return this.tag.id}_index=0;get index(){return this._index}_type=0;get typeId(){return this._type}get type(){return r.g.tags.idPalette.getStringId(this.typeId)}tag;node;constructor(){}tagArray;setTag(t,e,s){return this.node=t,this._type=e,this._index=s,this.tagArray=t.graph._tags[e],this.tag=r.g.tags.get(this.typeId),this}dispose(){return this.tagArray.removeTag(this._index)}toJSON(){return this.id}}},2709:(t,e,s)=>{s.d(e,{Z:()=>r});class r{_count=0;_palette=[];_map={};constructor(t){if(t){const e=t.length;for(let s=0;s<e;s++)this.register(t[s])}}get size(){return this._count}register(t){const e=this._count;return this._count++,this._palette[e]=t,this._map[t]=e,e}get(){return this._palette}getMap(){return this._map}isRegistered(t){return void 0!==this._map[t]}getNumberId(t){return this._map[t]}getStringId(t){return this._palette[t]}}},41168:(t,e,s)=>{s.d(e,{K:()=>r});class r{items=[];maxSize=1/0;addItem(t){return!(this.items.length>this.maxSize||(this.items.push(t),0))}get(){return this.items.shift()||null}}},82180:(t,e,s)=>{s.d(e,{c:()=>r});class r{observers=[];once=null;constructor(){}listener(t){return t}subscribe(t){this.observers.push(t)}unsubscribe(t){for(let e=0;e<this.observers.length;e++)if(this.observers[e]==t)return this.observers.splice(e,1),this.once&&this.once.has(t)&&this.once.delete(t),!0;return!1}subscribeOnce(t){this.observers.push(t),this.once||(this.once=new Set),this.once.add(t)}notify(t){for(let e=this.observers.length-1;e>=0;e--){const s=this.observers[e];s(t),this.once&&this.once.has(s)&&(this.observers.splice(e,1),this.once.delete(s))}}clear(){this.once&&this.once.clear(),this.observers.length=0}}},3620:(t,e,s)=>{s.d(e,{$m:()=>r.$});var r=s(50464);s(33335),s(14740),s(22487),s(31058),s(19083),s(59252),s(74182),s(26564),s(18852),s(82895)},47464:(t,e,s)=>{s.d(e,{hz:()=>n.h,wn:()=>r.w});var r=s(44575),n=s(38717);s(75025)}}]);